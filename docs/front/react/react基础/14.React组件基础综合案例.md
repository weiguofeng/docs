# 14.React组件基础综合案例





#### 1.评论列表案例

![1628176278388](../../../.vuepress/public/images/1628176278388.png)

![1628176333109](../../../.vuepress/public/images/1628176333109.png)

**需求分析**

![1628176488964](../../../.vuepress/public/images/1628176488964.png)





基本JSX结构构件

![1628176545488](../../../.vuepress/public/images/1628176545488.png)

![1628176652634](../../../.vuepress/public/images/1628176652634.png)

**初始化状态**

![1628176916850](../../../.vuepress/public/images/1628176916850.png)



**进行渲染**

![1628176818882](../../../.vuepress/public/images/1628176818882.png)







#### 2.渲染暂无评论

![1628177115709](../../../.vuepress/public/images/1628177115709.png)

如果没有数据数据-我们应该渲染个暂无评论，如果有数据那么 暂无评论就应该不渲染，只渲染数据就可以了

![1628235820594](../../../.vuepress/public/images/1628235820594.png)

![1628235951274](../../../.vuepress/public/images/1628235951274.png)





 以上代码结构不够清晰，因为有很多逻辑在jsx中，我们需要优化一下代码-优化代码一定是在功能已经实现的基础上进行优化的。

​	我们使用函数的方式进行代码的优化，用函数返回值的方式返回我们需要的东西

![1628236311034](../../../.vuepress/public/images/1628236311034.png)

![1628236267489](../../../.vuepress/public/images/1628236267489.png)



可能感觉三元表达不够清晰，那么我们使用if else也是可以的

![1628236441957](../../../.vuepress/public/images/1628236441957.png)





#### 3.获取评论信息

​	我们使用受控组件的方式来获取评论信息



先初始化信息

![1628236717989](../../../.vuepress/public/images/1628236717989.png)

![1628236767969](../../../.vuepress/public/images/1628236767969.png)



设置name和优化一下state

![1628236842882](../../../.vuepress/public/images/1628236842882.png)





添加事件处理程序：参数e是事件处理对象，我们需要拿到name和value，那么我们使用结构语法 const {name,value} = e.target 其实相当于 name=e.target.name和value=e.target.value,

然后进行值的改变设置 ES6语法 [name] ：value 相当于name对应的value

![1628236963283](../../../.vuepress/public/images/1628236963283.png)



然后表单里面都添加一个事件onChange

![1628237354664](../../../.vuepress/public/images/1628237354664.png)







#### 4.发表评论

​	获取表单信息已经可以了，那么现在就需要实现发表评论的功能了

​	1.给按钮绑定单击事件，单击后触发发表评论的功能

​	2.在事件处理程序中，通过state获取评论信息

​	3.将评论信息先添加到state中，并调用setState（）方法更新state



​	**给按钮添加事件**

![1628237990894](../../../.vuepress/public/images/1628237990894.png)





通过数组的扩展运算符，拿到一个新的数据 [...List ],如果是往前加数据 [ {}, ...List] 这个{}代表要往前面添加的数据，为什么是对象呢，因为数组中的每一个元素都是一个对象

![1628238357143](../../../.vuepress/public/images/1628238357143.png)







数据有了之后，我们需要渲染到页面的列表中，更新状态

​	将旧的comments更新为新的newComments

![1628238459179](../../../.vuepress/public/images/1628238459179.png)



![1628238520843](../../../.vuepress/public/images/1628238520843.png)



#### 5.优化评论功能

​	评论的功能是实现了，但是发表完评论后，其实我们还应该将，输入框的内容清空处理一下。还有就是在我们什么都没有输入的情况点击发表的话会有一个空值的评论。

​		如何设置空值，其实就是将获取到的表单内容属性值，在设置值的时候设置为空就可以了

![1628238900051](../../../.vuepress/public/images/1628238900051.png)





​	加判断进行对输入的校验，严格一点使用tram就是去除空格之后再判断是否为空

![1628239504888](../../../.vuepress/public/images/1628239504888.png)

return是防止后续代码的执行



![1628239536080](../../../.vuepress/public/images/1628239536080.png)





















