# 18.权限列表-配置







先设置个开关--使用这种气泡卡片的方式

![1638860006702](../../../../.vuepress/public/images/1638860006702.png)







代码测试一下：

![1638860196149](../../../../.vuepress/public/images/1638860196149.png)



页面查看效果

![1638863426944](../../../../.vuepress/public/images/1638863426944.png)



在div中加入switch

![1638863724776](../../../../.vuepress/public/images/1638863724776.png)





我们要的效果就是这样的--那么我们需要在div中加入一个switch开关就可以了

![1638863571230](../../../../.vuepress/public/images/1638863571230.png)



现在有个问题就是--目前有这个字段的是支持开关的，子菜单没有这个字段 目前是不支持开关的

![1638863805492](../../../../.vuepress/public/images/1638863805492.png)



我们在代码中加入disable 如果这个字段是undefined 那么就禁用这个按钮

![1638863922325](../../../../.vuepress/public/images/1638863922325.png)





页面查看效果：

![1638863989785](../../../../.vuepress/public/images/1638863989785.png)



目前还有点小问题：已经禁用了--但是还可以点开

![1638960197806](../../../../.vuepress/public/images/1638960197806.png)





这个可能是trigger触发的--这个trigger是个click

![1638960271012](../../../../.vuepress/public/images/1638960271012.png)



我们将这个trigger改为空---这样是不行的，导致都无法点开了

![1638960299555](../../../../.vuepress/public/images/1638960299555.png)



我们需要改为动态的判断一下

![1638960417230](../../../../.vuepress/public/images/1638960417230.png)



好了--现在点击不会弹出了

![1638960468529](../../../../.vuepress/public/images/1638960468529.png)







#### 2、设置开关

我们打开这个开关后--默认其实应该是打开的状态

​		需要给这个Switch组件传一个true就可以为默认打开了

![1638960625430](../../../../.vuepress/public/images/1638960625430.png)







页面查看效果：

![1638960571374](../../../../.vuepress/public/images/1638960571374.png)







#### 3、动态设置开关

​		是开还是关--还是需要后台的数据来支持的

​		我们的pagepermisson 如果是1就是打的  如果是0就是不打开

![1638960719874](../../../../.vuepress/public/images/1638960719874.png)



现在又有一个问题：就是开关关闭不了了--改为动态后点击关闭按钮无法关闭

​		原因是：switch是一个受控组件--他的值一直受到影响无法关闭，因为他现在受这个字段状态的控制着呢

![1638960971988](../../../../.vuepress/public/images/1638960971988.png)



然后我们需要给Switch加一个事件处理onChange--传入item

![1638961224859](../../../../.vuepress/public/images/1638961224859.png)



然后我们在函数中修改item的值，其实修改item的值也就相当于修改datasource的值了，因为DataSource是引用数据--那么页面就会受到修改值的影响

​			我们使用三元进行取反操作

![1638961457692](../../../../.vuepress/public/images/1638961457692.png)



然后我们现在可以再次setState一下dataSource

![1638961598273](../../../../.vuepress/public/images/1638961598273.png)

这样处理之后--开关的点击就好使了



然后我们同步一下后端的数据--请求的时候使用patch补丁请求--因为post会导致全部更新，patch是局部的

​		if中的判断是根据不同菜单级别进行不同的操作

![1638961817520](../../../../.vuepress/public/images/1638961817520.png)







测试效果：

将首页的开关设置为关闭

![1638962086261](../../../../.vuepress/public/images/1638962086261.png)





再次刷新页面后--左侧菜单栏的首页就消失了，然后按钮默认也变成关闭了

![1638962150405](../../../../.vuepress/public/images/1638962150405.png)





然后我们回忆一下之前的流程图--我们已经实现了这个**权限控制能够影响这个侧边栏使用**功能



![1638962254571](../../../../.vuepress/public/images/1638962254571.png)





















































































































