



# 22.城市选择模块

## 1、功能分析

![1632753089554](../../../.vuepress/public/images/1632753089554.png)



### 2.顶部导航栏实现

![1632753193743](../../../.vuepress/public/images/1632753193743.png)

![1632753256054](../../../.vuepress/public/images/1632753256054.png)



**开始步骤：**

1、参考文档：

![1632753381803](../../../.vuepress/public/images/1632753381803.png)

导入icon组件是图标





2、拷贝到项目中

![1632753562116](../../../.vuepress/public/images/1632753562116.png)



navbar可以正常运行了

![1632753464941](../../../.vuepress/public/images/1632753464941.png)





3、修改导航栏的样式，调整样式结构

​	分析拷贝过来的内容

![1632753868802](../../../.vuepress/public/images/1632753868802.png)



![1632753915069](../../../.vuepress/public/images/1632753915069.png)



页面展示：

![1632753930366](../../../.vuepress/public/images/1632753930366.png)

返回的《图标颜色不对，我们使用自己的图标库的图标

![1632754063858](../../../.vuepress/public/images/1632754063858.png)

![1632754127745](../../../.vuepress/public/images/1632754127745.png)

![1632754147547](../../../.vuepress/public/images/1632754147547.png)

现在基本效果差不多了







完成点击按钮返回上一个页面

![1632754265256](../../../.vuepress/public/images/1632754265256.png)



返回到上一页了，测试没问题

![1632754296754](../../../.vuepress/public/images/1632754296754.png)







### 3.获取并处理城市数据列表



**步骤：**

![1632754581663](../../../.vuepress/public/images/1632754581663.png)



**1、获取城市数据：**

​		先导入axios因为需要发起请求---然后在页面渲染之前获取数据，那就需要在componentDidMount这个钩子函数中写请求获取数据---最好的是我们封装一个方法，在钩子函数中调用这个方法更加合适



![1632755735817](../../../.vuepress/public/images/1632755735817.png)





**拿到列表数据**

![1632755680505](../../../.vuepress/public/images/1632755680505.png)

第一步完成了





**2、分析当前数据**

![1632756218877](../../../.vuepress/public/images/1632756218877.png)



这个数据结构并不能满足我们页面需要的展示结构----需要字母的索引来展示

![1632756921478](../../../.vuepress/public/images/1632756921478.png)



我们需要按字母索引分组的数据类型---最后我们还需要一个字母数组来保证他们的顺序

![1632757024936](../../../.vuepress/public/images/1632757024936.png)





#### 3、转化数据--转化为我们需要的格式

![1632757352245](../../../.vuepress/public/images/1632757352245.png)



cityList是处理完返回的数据---cityIndex是返回的索引字母



![1632757430534](../../../.vuepress/public/images/1632757430534.png)



根据sort的首字母进行分类

![1632758055518](../../../.vuepress/public/images/1632758055518.png)



![1632758011017](../../../.vuepress/public/images/1632758011017.png)



开始遍历处理数据：

![1632758313219](../../../.vuepress/public/images/1632758313219.png)



转化数据查看一下：分类数据已经拿到了

![1632758399045](../../../.vuepress/public/images/1632758399045.png)



然后我们拿到分类数据的每一个键，就可以得到索引数据了

通过Object.keys可以直接获取到对象的key，然后sort一下排序

![1632758695827](../../../.vuepress/public/images/1632758695827.png)



![1632758720714](../../../.vuepress/public/images/1632758720714.png)



拿到索引数据：

![1632758941383](../../../.vuepress/public/images/1632758941383.png)





#### 4、获取热门城市数据，并添加到现有数据列表中

![1632759484699](../../../.vuepress/public/images/1632759484699.png)



![1632759507145](../../../.vuepress/public/images/1632759507145.png)



将索引数据里面添加hot索引--使用unshift方法，是在第一条数据再加一条数据放在首位

![1632759642996](../../../.vuepress/public/images/1632759642996.png)



查看一下

![1632759671040](../../../.vuepress/public/images/1632759671040.png)





bilibili.com/video/BV14y4y1g7M4?p=135&spm_id_from=pageDriver





















































































































