# 27.点击索引置顶该索引城市



想要达到的效果：其实就是我们点击右侧字母索引---然后将对应的城市给置顶显示

![1636703116361](../../../.vuepress/public/images/1636703116361.png)





**实现步骤：**

![1636706097886](../../../.vuepress/public/images/1636706097886.png)



主要是使用到List组件的scrollToRow这个方法：这个方法的作用就是被用于安全的滚动到指定的行

​	但是这个有一个限制就是 Ensure row is visible 这个行必须是可见的---意思就是这个行必须是出现过可视区域内的。如果你这行还没有渲染过就可能发生定位不准确的问题。

![1636705793849](../../../.vuepress/public/images/1636705793849.png)





##### 代码实现：

1、绑定事件：

![1636706192173](../../../.vuepress/public/images/1636706192173.png)





2.调用scrollToRow方法-让List滚动到指定行，那么怎么调用这个方法呢，就需要创建ref对象

​	在constructor中，调用React.createRef() 创建ref对象

![1636706565411](../../../.vuepress/public/images/1636706565411.png)





然后在List组件中 指定一下创建好的ref对象，就是将ref对象和List组件关联到一起

![1636707662076](../../../.vuepress/public/images/1636707662076.png)









然后通过ref的current 属性，获取到组件实例，再调用组件的scrollToRow方法

现在我们可以在事件中调用scrollToRow方法了

![1636706831527](../../../.vuepress/public/images/1636706831527.png)







查看页面效果：点击J发生滚动-但是定位不准确--并没有置顶

![1636706881472](../../../.vuepress/public/images/1636706881472.png)



通过设置List组件的scrollToAlignment 属性   来置顶

![1636707724166](../../../.vuepress/public/images/1636707724166.png)



查看效果：点击字母J----定位准确

![1636707853246](../../../.vuepress/public/images/1636707853246.png)







如果没有在页面显示，定位的时候就会发生精度的问题，如何解决



调用List 组件的 measureAllRows  方法，提前计算高度来解决，使用钩子函数componentDidMount()在页面渲染完毕后计算高度

![1636708970930](../../../.vuepress/public/images/1636708970930.png)



可能发生报错：

![1636709056529](../../../.vuepress/public/images/1636709056529.png)





原因是异步调用获取数据的时候List还没执行完毕，然后就执行高度计算导致的

​	我们通过await 等待执行完成List有数据后再执行

![1636709295537](../../../.vuepress/public/images/1636709295537.png)





查看效果： 点击X，定位完全正确

![1636709462889](../../../.vuepress/public/images/1636709462889.png)















































































































































































































































