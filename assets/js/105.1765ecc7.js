(window.webpackJsonp=window.webpackJsonp||[]).push([[105],{2646:function(t,s,p){t.exports=p.p+"assets/img/1639719797506.410c62ac.png"},2647:function(t,s,p){t.exports=p.p+"assets/img/1639721751201.1dccb812.png"},2648:function(t,s,p){t.exports=p.p+"assets/img/1639722003518.69fadcc8.png"},2649:function(t,s,p){t.exports=p.p+"assets/img/1639722222891.b7fcdd2f.png"},2650:function(t,s,p){t.exports=p.p+"assets/img/1639722509221.c150550a.png"},2651:function(t,s,p){t.exports=p.p+"assets/img/1639722748392.e5c3fbf3.png"},2652:function(t,s,p){t.exports=p.p+"assets/img/1639722928686.df4eca77.png"},2653:function(t,s,p){t.exports=p.p+"assets/img/1639723185450.b9725efc.png"},2654:function(t,s,p){t.exports=p.p+"assets/img/1639723578570.727ac51d.png"},2655:function(t,s,p){t.exports=p.p+"assets/img/1639723372641.ab905837.png"},2656:function(t,s,p){t.exports=p.p+"assets/img/1639723815647.46f8b4c3.png"},2657:function(t,s,p){t.exports=p.p+"assets/img/1639724273660.6c58aec0.png"},2658:function(t,s,p){t.exports=p.p+"assets/img/1639724475490.88ff27a8.png"},2659:function(t,s,p){t.exports=p.p+"assets/img/1639725469908.65b10bc3.png"},2660:function(t,s,p){t.exports=p.p+"assets/img/1639725627022.073be614.png"},2661:function(t,s,p){t.exports=p.p+"assets/img/1639726084671.7d85cb42.png"},2662:function(t,s,p){t.exports=p.p+"assets/img/1639726129440.b81440a4.png"},2663:function(t,s,p){t.exports=p.p+"assets/img/1639726277395.b1e5f4da.png"},2664:function(t,s,p){t.exports=p.p+"assets/img/1639726453906.56a8316a.png"},2665:function(t,s,p){t.exports=p.p+"assets/img/1639726667515.bda403ae.png"},2666:function(t,s,p){t.exports=p.p+"assets/img/1639726721428.25d5cdb2.png"},8423:function(t,s,p){"use strict";p.r(s);var a=p(5),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_4-登录页面-用户列表"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-登录页面-用户列表"}},[t._v("#")]),t._v(" 4.登录页面-用户列表")]),t._v(" "),a("p",[t._v("先处理一下小问题，将欢迎的用户颜色改变一下")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2646),alt:"1639719797506"}})]),t._v(" "),a("p",[t._v("如果使用一个区域管理员登录的话--查看他的用户管理--发现可以管理全部的用户，这就有问题了")]),t._v(" "),a("p",[t._v("​\t\t区域管理员--他其实应该只能添加或者编辑自己区域下的用户权限")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2647),alt:"1639721751201"}})]),t._v(" "),a("p",[t._v("而且如果是区域管理员在新增用户的时候--应该只能新增自己区域内的用户-其他区域是不可以选的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2648),alt:"1639722003518"}})]),t._v(" "),a("h4",{attrs:{id:"_1、处理用户列表问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、处理用户列表问题"}},[t._v("#")]),t._v(" 1、处理用户列表问题")]),t._v(" "),a("p",[t._v("​\t\t首先分析原因：在userList中全部展示用户这个就不对")]),t._v(" "),a("p",[t._v("我们在请求用户列表的时候-其实就应该过滤一下条件，而不是加载全部用户列表")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2649),alt:"1639722222891"}})]),t._v(" "),a("p",[t._v("由于我们使用的是JSONServer做后端--所以这个过滤就前端来处理吧---按正常是后端来进行处理及返回的")]),t._v(" "),a("p",[t._v("我们先将用户token保存的数据获取--然后结构一下我们需要的数据")]),t._v(" "),a("p",[t._v("​\t\t需要roleid来判断权限，需要region来判断区域")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2650),alt:"1639722509221"}})]),t._v(" "),a("p",[t._v("我们根据roleId来进行判断--如果直接使用roleId===1这种看起来有点迷糊，我们可以定义一个映射对象来区分一下")]),t._v(" "),a("p",[t._v("​\t判断如果是超级管理员就返回全部的用户列表")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2651),alt:"1639722748392"}})]),t._v(" "),a("p",[t._v("判断如果不是超级管理员的情况")]),t._v(" "),a("p",[t._v("​\t\t1、展示自己item.username===结构出来的username")]),t._v(" "),a("p",[t._v("​\t\t2、过滤和我是同一区域下的，&&并且roleId为3 也就是普通用户的角色")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2652),alt:"1639722928686"}})]),t._v(" "),a("p",[t._v("页面查看一下效果：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2653),alt:"1639723185450"}})]),t._v(" "),a("p",[t._v("显示正常--但是有些警告")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2654),alt:"1639723578570"}})]),t._v(" "),a("p",[t._v("由于hooks写法可能会--页面有警告-说没有告诉他使用的这些值，我们传入告诉他一下解决警告")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2655),alt:"1639723372641"}})]),t._v(" "),a("h4",{attrs:{id:"_2、解决添加用户时的选择问题处理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、解决添加用户时的选择问题处理"}},[t._v("#")]),t._v(" 2、解决添加用户时的选择问题处理")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2656),alt:"1639723815647"}})]),t._v(" "),a("p",[t._v("问题原因分析：我们在表单的处理中也需要过滤一下，我们还需要将添加和更新的逻辑分开一下")]),t._v(" "),a("p",[t._v("我们给Form传入的时候--传入一个指标来判断是新增的还是更新的 isUpdate是true就是更新操作")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2657),alt:"1639724273660"}})]),t._v(" "),a("p",[t._v("我们先测试一下当更新的时候 isUpdate是true")]),t._v(" "),a("p",[t._v("如果是超级管理员--就return false ， 就说明disable是false 不禁用")]),t._v(" "),a("p",[t._v("如果不是超级管理员---返回true为禁用")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2658),alt:"1639724475490"}})]),t._v(" "),a("p",[t._v("页面查看效果：发现区域已经没有修改的权限了，只能是自己所在的区域")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2659),alt:"1639725469908"}})]),t._v(" "),a("p",[t._v("超级管理员是不受限制的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2660),alt:"1639725627022"}})]),t._v(" "),a("p",[t._v("限制我们处理另外一个分支--创建用户的时候")]),t._v(" "),a("p",[t._v("​\t\t如果是超级管理员没有限制都可以选择")]),t._v(" "),a("p",[t._v("​\t\t如果不是超级管理员--将不属于自己所属区域的其他区域禁用")]),t._v(" "),a("p",[t._v("将item传入--用于后续判断处理")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2661),alt:"1639726084671"}})]),t._v(" "),a("p",[a("img",{attrs:{src:p(2662),alt:"1639726129440"}})]),t._v(" "),a("p",[t._v("现在我们页面查看一下效果： 添加用户的时候显示的为自己的区域")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2663),alt:"1639726277395"}})]),t._v(" "),a("h4",{attrs:{id:"_3、处理角色select选项"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、处理角色select选项"}},[t._v("#")]),t._v(" 3、处理角色Select选项")]),t._v(" "),a("p",[t._v("​\t同理--我们也需要处理一下角色的select下拉框")]),t._v(" "),a("p",[t._v("​\t\t定义一个checkRoleDisable函数")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2664),alt:"1639726453906"}})]),t._v(" "),a("p",[t._v("函数分支处理")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2665),alt:"1639726667515"}})]),t._v(" "),a("p",[t._v("页面查看效果：好使的 区域管理员只能创建 区域编辑用户")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2666),alt:"1639726721428"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);