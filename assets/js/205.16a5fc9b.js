(window.webpackJsonp=window.webpackJsonp||[]).push([[205],{6489:function(s,a,n){s.exports=n.p+"assets/img/image-20220421220800247.6951ec2f.png"},6490:function(s,a,n){s.exports=n.p+"assets/img/image-20220421221508108.6ac7a634.png"},6491:function(s,a,n){s.exports=n.p+"assets/img/image-20220421221538782.29eae0da.png"},6492:function(s,a,n){s.exports=n.p+"assets/img/image-20220421221811421.3e3b6bd6.png"},6493:function(s,a,n){s.exports=n.p+"assets/img/image-20220421221942489.66c8e572.png"},6494:function(s,a,n){s.exports=n.p+"assets/img/image-20220421222559423.bd0300bb.png"},6495:function(s,a,n){s.exports=n.p+"assets/img/image-20220421233846852.96808aeb.png"},6496:function(s,a,n){s.exports=n.p+"assets/img/image-20220421234213661.534233ea.png"},6497:function(s,a,n){s.exports=n.p+"assets/img/image-20220421234438071.c98a2433.png"},6498:function(s,a,n){s.exports=n.p+"assets/img/image-20220421235556389.adac6d5a.png"},6499:function(s,a,n){s.exports=n.p+"assets/img/image-20220421235823795.47d9df05.png"},6500:function(s,a,n){s.exports=n.p+"assets/img/image-20220422000307979.b2acb24a.png"},6501:function(s,a,n){s.exports=n.p+"assets/img/image-20220422000923594.f2ed99d1.png"},6502:function(s,a,n){s.exports=n.p+"assets/img/image-20220422001411804.3ee797ab.png"},8850:function(s,a,n){"use strict";n.r(a);var t=n(5),e=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_10-k8s集群搭建-初始化主节点"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_10-k8s集群搭建-初始化主节点"}},[s._v("#")]),s._v(" 10.k8s集群搭建-初始化主节点")]),s._v(" "),t("p",[s._v("​\t我们下面使用kubeadm引导启动集群，主要启动集群我们先来想一下这么几个事情，未来厂长kubelet会在每一台机器上，比如每台机器上都有kube-proxy，就相当于先由这个厂长下载镜像然后启动这个应用的")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6489),alt:"image-20220421220800247"}})]),s._v(" "),t("p",[s._v("​\t所以除了kubelet，剩下的应用都是以容器化的方式运行，先下载镜像，再来启动容器的，所以这个镜像呢我们可以提前下载下来，担心安装的过程中下载的中途卡主了，我们也不清楚卡在哪里了，所以我们准备了提前下载镜像的脚本")]),s._v(" "),t("h2",{attrs:{id:"_1、使用kubeadm引导集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、使用kubeadm引导集群"}},[s._v("#")]),s._v(" 1、使用kubeadm引导集群")]),s._v(" "),t("h4",{attrs:{id:"_1、下载各个机器需要的镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1、下载各个机器需要的镜像"}},[s._v("#")]),s._v(" 1、下载各个机器需要的镜像")]),s._v(" "),t("p",[s._v("脚本：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tee")]),s._v(" ./images.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<-")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'EOF'\n#!/bin/bash\nimages=(\nkube-apiserver:v1.20.9\nkube-proxy:v1.20.9\nkube-controller-manager:v1.20.9\nkube-scheduler:v1.20.9\ncoredns:1.7.0\netcd:3.4.13-0\npause:3.2\n)\nfor imageName in ${images[@]} ; do\ndocker pull registry.cn-hangzhou.aliyuncs.com/lfy_k8s_images/$imageName\ndone\nEOF")]),s._v("\n   \n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x ./images.sh "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" ./images.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("​\t我们复制第一个脚本命令到 EFO结束")]),s._v(" "),t("p",[s._v("​\t然后我们只需要在master节点执行")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6490),alt:"image-20220421221508108"}})]),s._v(" "),t("p",[s._v("看下效果：这个脚本产生的一个效果，会给我们产生一个images.sh的文件")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6491),alt:"image-20220421221538782"}})]),s._v(" "),t("p",[s._v("images.sh这个文件里面就是一个for循环，把我们需要的内容下载下来")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6492),alt:"image-20220421221811421"}})]),s._v(" "),t("p",[s._v("​\t然后我们给这个images.sh加一下权限，让他可以正常执行下载")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6493),alt:"image-20220421221942489"}})]),s._v(" "),t("p",[s._v("​")]),s._v(" "),t("p",[s._v("​\t\t现在master节点的机器就开始下载这些镜像了，那么第二台机器需要下载这些镜像吗？其实每台机器都是需要kube-proxy（门卫大爷）这个镜像的，所以这个镜像我们可以单独使用docker pull 来进行下载")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull registry.cn-hangzhou.aliyuncs.com/lfy_k8s_images/kube-proxy:v1.20.9\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("如果我们担心这些镜像可能缺，那么就和主节点一样，全部都执行一下")]),s._v(" "),t("p",[s._v("​\t我们下载完所有的镜像后，我们可以检查一下下载的内容：有7个镜像")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6494),alt:"image-20220421222559423"}})]),s._v(" "),t("p",[s._v("​\t然后我们接下来就使用kubeadm工具先把k8s-master变成我们的主节点，如何做呢？")]),s._v(" "),t("p",[s._v("​\t首先特别关键的一步：需要修改为自己的，先拿到集群内网的IP，如:172.31.0.2")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6495),alt:"image-20220421233846852"}})]),s._v(" "),t("p",[s._v("​\t这相当于master节点的ip，也叫集群入口的节点，然后给etc/host中添加一个域名映射")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#所有机器添加master域名映射，以下需要修改为自己的")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.31.0.4  cluster-endpoint"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">>")]),s._v(" /etc/hosts\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[s._v("​\t要让所有节点都知道master节点在哪，所以每个节点都需要添加这个命令")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6496),alt:"image-20220421234213661"}})]),s._v(" "),t("p",[s._v("执行后，最终完成效果是什么呢？如果我们ping这个域名cluster-endpoint可以ping通就ok了")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6497),alt:"image-20220421234438071"}})]),s._v(" "),t("h4",{attrs:{id:"主节点初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#主节点初始化"}},[s._v("#")]),s._v(" 主节点初始化")]),s._v(" "),t("p",[s._v("​\t我们现在使用kubeadm帮我们快速初始化一个主节点，然后主节点需要")]),s._v(" "),t("p",[s._v("​\t设置主节点master的ip（--apiserver-adverties-address）,")]),s._v(" "),t("p",[s._v("​\t然后设置主节点的域名（--control-plane-endpoint）")]),s._v(" "),t("p",[s._v("​\t设置镜像仓库（--image-repository）")]),s._v(" "),t("p",[s._v("​\t设置k8s的版本（--kubernate-version）")]),s._v(" "),t("p",[s._v("​\t设置网络范围（--service-cidr负载均衡用的，--pod-network-cidr）--这个我们后续再说，如果要改要保证这俩个网络范围不重叠，也不能和我们机器的ip重叠，这些我们使用默认的就可以")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#主节点初始化")]),s._v("\nkubeadm init "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--apiserver-advertise-address"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("172.31")]),s._v(".0.4 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--control-plane-endpoint"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("cluster-endpoint "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--image-repository registry.cn-hangzhou.aliyuncs.com/lfy_k8s_images "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--kubernetes-version v1.20.9 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--service-cidr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("10.96")]),s._v(".0.0/16 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--pod-network-cidr"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.0/16\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#所有网络范围不重叠")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("​\t这个脚本只在主节点运行")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6498),alt:"image-20220421235556389"}})]),s._v(" "),t("p",[s._v("稍等一会儿：如果看到 你的k8s控制面变已经初始化成功就OK了")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6499),alt:"image-20220421235823795"}})]),s._v(" "),t("p",[s._v("​\t\t我们把初始化成功的提示复制出来看一下：可以看到提示 To Start 如果你要使用集群，你需要运行内容的提示")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("Your Kubernetes control-plane has initialized successfully"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\nTo start using your cluster, you need to run the following as a regular user:\n\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -i /etc/kubernetes/admin.conf "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -u"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -g"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n\nAlternatively, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" you are the root user, you can run:\n\n  "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("KUBECONFIG")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc/kubernetes/admin.conf\n\nYou should now deploy a pod network to the cluster.\nRun "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubectl apply -f [podnetwork].yaml"')]),s._v(" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\nYou can now "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" any number of control-plane nodes by copying certificate authorities\nand "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" account keys on each "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("node")]),s._v(" and "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" running the following as root:\n\n  kubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" cluster-endpoint:6443 --token hums8f.vyx71prsg74ofce7 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --discovery-token-ca-cert-hash sha256:a394d059dd51d68bb007a532a037d0a477131480ae95f75840c461e85e2c6ae3 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --control-plane \n\nThen you can "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" any number of worker nodes by running the following on each as root:\n\nkubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" cluster-endpoint:6443 --token hums8f.vyx71prsg74ofce7 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --discovery-token-ca-cert-hash sha256:a394d059dd51d68bb007a532a037d0a477131480ae95f75840c461e85e2c6ae3\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br")])]),t("p",[s._v("​\t这段成功的脚本必须copy下来，因为后续会使用到，比如，我们在其他节点运行kubeadm join 。。。。。可以将节点设置为主节点（因为集群里面可以有多个主节点-多个领导构成董事会）")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6500),alt:"image-20220422000307979"}})]),s._v(" "),t("p",[s._v("​\t你也可以加入任意多个worker节点（工作节点）,如果想加入多个工作节点可以使用这些命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("Then you can "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" any number of worker nodes by running the following on each as root:\n\nkubeadm "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" cluster-endpoint:6443 --token hums8f.vyx71prsg74ofce7 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    --discovery-token-ca-cert-hash sha256:a394d059dd51d68bb007a532a037d0a477131480ae95f75840c461e85e2c6ae3\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[s._v("​\t我们想使用我们的集群先来这一步：有3条命令，创建目录，把核心配置文件复制到这个目录中，然后给一些用户组权限")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("\t"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" -i /etc/kubernetes/admin.conf "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n  "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chown")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -u"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("id")]),s._v(" -g"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$HOME")]),s._v("/.kube/config\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("p",[t("img",{attrs:{src:n(6501),alt:"image-20220422000923594"}})]),s._v(" "),t("p",[s._v("​\t\t这个执行完毕后，你应该现在在集群中部署一个网络节点 pod network，他会把所有集群中的机器给串起来打通")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("You should now deploy a pod network to the cluster.\nRun "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubectl apply -f [podnetwork].yaml"')]),s._v(" with one of the options listed at:\n  https://kubernetes.io/docs/concepts/cluster-administration/addons/\n\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("​\t\t如果我们想看一下我们集群中所有的节点：使用kubectl get nodes，我们看到现在集群中只有一个主节点，状态是NotRead，NotRead的原因是我们没有做上一步 部署一个网络节点")]),s._v(" "),t("p",[t("img",{attrs:{src:n(6502),alt:"image-20220422001411804"}})]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看集群所有节点")]),s._v("\nkubectl get nodes\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#根据配置文件，给集群创建资源")]),s._v("\nkubectl apply -f xxxx.yaml\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#查看集群部署了哪些应用？")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("==")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("   kubectl get pods -A\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行中的应用在docker里面叫容器，在k8s里面叫Pod")]),s._v("\nkubectl get pods -A\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("​")])])}),[],!1,null,null,null);a.default=e.exports}}]);