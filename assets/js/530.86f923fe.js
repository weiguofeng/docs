(window.webpackJsonp=window.webpackJsonp||[]).push([[530],{5278:function(s,n,t){s.exports=t.p+"assets/img/1625500798683.9caac3e3.png"},5279:function(s,n){s.exports="data:image/png;base64,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"},5280:function(s,n,t){s.exports=t.p+"assets/img/1625501465050.cc2d2d5c.png"},5281:function(s,n,t){s.exports=t.p+"assets/img/1625501499679.307de0d9.png"},9242:function(s,n,t){"use strict";t.r(n);var e=t(5),a=Object(e.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"分布式锁是啥-对比下redis和zk两种分布式锁的优劣"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分布式锁是啥-对比下redis和zk两种分布式锁的优劣"}},[s._v("#")]),s._v(" 分布式锁是啥？对比下redis和zk两种分布式锁的优劣")]),s._v(" "),e("h4",{attrs:{id:"_1-面试题"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_1-面试题"}},[s._v("#")]),s._v(" 1.面试题")]),s._v(" "),e("p",[s._v("​\t"),e("strong",[s._v("一般实现分布式锁都有哪些方式？使用redis如何设计分布式锁？使用zk来设计分布式锁可以吗？这俩种分布式锁的实现方式那种效率比较高？")])]),s._v(" "),e("h4",{attrs:{id:"_2-面试官心里分析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-面试官心里分析"}},[s._v("#")]),s._v(" 2.面试官心里分析")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("\t其实一般问问题，都是这么问的，先问问你zk，然后其实是要过渡到zk关联的一些问题里去，比如分布式锁，因为在分布式系统开发中，分布式锁的使用场景还是很常见的。\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h4",{attrs:{id:"_3-面试题剖析"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-面试题剖析"}},[s._v("#")]),s._v(" 3.面试题剖析")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\t1.redis分布式锁：\n\t官方叫做RedLock算法，是redis官方支持的分布式锁算法。\n\t\n\t这个分布式锁有3个重要的考量点，互斥（只能有一个客户端获取锁），不能死锁，容错（大部分redis节点或者这个锁就可以加可以释放）\n\n第一个最普通的实现方式，如果就是在redis里创建一个key算加锁\n\nSET my:lock 随机值 NX PX 30000，这个命令就ok，这个的NX的意思就是只有key不存在的时候才会设置成功，PX 30000的意思是30秒后锁自动释放。别人创建的时候如果发现已经有了就不能加锁了。\n\n释放锁就是删除key，但是一般可以用lua脚本删除，判断value一样才删除：\n\n关于redis如何执行lua脚本，自行百度\n\nif redis.call("get",KEYS[1]) == ARGV[1] then\nreturn redis.call("del",KEYS[1])\nelse\n    return 0\nend\n\n为啥要用随机值呢？因为如果某个客户端获取到了锁，但是阻塞了很长时间才执行完，此时可能已经自动释放锁了，此时可能别的客户端已经获取到了这个锁，要是你这个时候直接删除key的话会有问题，所以得用随机值加上面的lua脚本来释放锁。\n\n但是这样是肯定不行的。因为如果是普通的redis单实例，那就是单点故障。或者是redis普通主从，那redis主从异步复制，如果主节点挂了，key还没同步到从节点，此时从节点切换为主节点，别人就会拿到锁。\n\n第二个问题，RedLock算法\n\n这个场景是假设有一个redis cluster，有5个redis master实例。然后执行如下步骤获取一把锁：\n\n1）获取当前时间戳，单位是毫秒\n2）跟上面类似，轮流尝试在每个master节点上创建锁，过期时间较短，一般就几十毫秒\n3）尝试在大多数节点上建立一个锁，比如5个节点就要求是3个节点（n / 2 +1）\n4）客户端计算建立好锁的时间，如果建立锁的时间小于超时时间，就算建立成功了\n5）要是锁建立失败了，那么就依次删除这个锁\n6）只要别人建立了一把分布式锁，你就得不断轮询去尝试获取锁\n\n\t\n\t\n\t\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br")])]),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\t（2）zk分布式锁\n\nzk分布式锁，其实可以做的比较简单，就是某个节点尝试创建临时znode，此时创建成功了就获取了这个锁；这个时候别的客户端来创建锁会失败，只能注册个监听器监听这个锁。释放锁就是删除这个znode，一旦释放掉就会通知客户端，然后有一个等待着的客户端就可以再次重新枷锁。\n\n/**\n * ZooKeeperSession\n * @author Administrator\n *\n */\npublic class ZooKeeperSession {\n\t\n\tprivate static CountDownLatch connectedSemaphore = new CountDownLatch(1);\n\t\n\tprivate ZooKeeper zookeeper;\nprivate CountDownLatch latch;\n\n\tpublic ZooKeeperSession() {\n\t\ttry {\n\t\t\tthis.zookeeper = new ZooKeeper(\n\t\t\t\t\t"192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181", \n\t\t\t\t\t50000, \n\t\t\t\t\tnew ZooKeeperWatcher());\t\t\t\n\t\t\ttry {\n\t\t\t\tconnectedSemaphore.await();\n\t\t\t} catch(InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\n\t\t\tSystem.out.println("ZooKeeper session established......");\n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\t\n\t/**\n\t * 获取分布式锁\n\t * @param productId\n\t */\n\tpublic Boolean acquireDistributedLock(Long productId) {\n\t\tString path = "/product-lock-" + productId;\n\t\n\t\ttry {\n\t\t\tzookeeper.create(path, "".getBytes(), \n\t\t\t\t\tIds.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);\nreturn true;\n\t\t} catch (Exception e) {\nwhile(true) {\n\t\t\t\ttry {\nStat stat = zk.exists(path, true); // 相当于是给node注册一个监听器，去看看这个监听器是否存在\nif(stat != null) {\nthis.latch = new CountDownLatch(1);\nthis.latch.await(waitTime, TimeUnit.MILLISECONDS);\nthis.latch = null;\n}\nzookeeper.create(path, "".getBytes(), \n\t\t\t\t\t\tIds.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL);\nreturn true;\n} catch(Exception e) {\ncontinue;\n}\n}\n\n// 很不优雅，我呢就是给大家来演示这么一个思路\n// 比较通用的，我们公司里我们自己封装的基于zookeeper的分布式锁，我们基于zookeeper的临时顺序节点去实现的，比较优雅的\n\t\t}\nreturn true;\n\t}\n\t\n\t/**\n\t * 释放掉一个分布式锁\n\t * @param productId\n\t */\n\tpublic void releaseDistributedLock(Long productId) {\n\t\tString path = "/product-lock-" + productId;\n\t\ttry {\n\t\t\tzookeeper.delete(path, -1); \n\t\t\tSystem.out.println("release the lock for product[id=" + productId + "]......");  \n\t\t} catch (Exception e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\t\n\t/**\n\t * 建立zk session的watcher\n\t * @author Administrator\n\t *\n\t */\n\tprivate class ZooKeeperWatcher implements Watcher {\n\n\t\tpublic void process(WatchedEvent event) {\n\t\t\tSystem.out.println("Receive watched event: " + event.getState());\n\n\t\t\tif(KeeperState.SyncConnected == event.getState()) {\n\t\t\t\tconnectedSemaphore.countDown();\n\t\t\t} \n\nif(this.latch != null) {  \nthis.latch.countDown();  \n}\n\t\t}\n\t\t\n\t}\n\t\n\t/**\n\t * 封装单例的静态内部类\n\t * @author Administrator\n\t *\n\t */\n\tprivate static class Singleton {\n\t\t\n\t\tprivate static ZooKeeperSession instance;\n\t\t\n\t\tstatic {\n\t\t\tinstance = new ZooKeeperSession();\n\t\t}\n\t\t\n\t\tpublic static ZooKeeperSession getInstance() {\n\t\t\treturn instance;\n\t\t}\n\t\t\n\t}\n\t\n\t/**\n\t * 获取单例\n\t * @return\n\t */\n\tpublic static ZooKeeperSession getInstance() {\n\t\treturn Singleton.getInstance();\n\t}\n\t\n\t/**\n\t * 初始化单例的便捷方法\n\t */\n\tpublic static void init() {\n\t\tgetInstance();\n\t}\n\t\n}\n\n\n（3）redis分布式锁和zk分布式锁的对比\n\nredis分布式锁，其实需要自己不断去尝试获取锁，比较消耗性能\n\nzk分布式锁，获取不到锁，注册个监听器即可，不需要不断主动尝试获取锁，性能开销较小\n\n另外一点就是，如果是redis获取锁的那个客户端bug了或者挂了，那么只能等待超时时间之后才能释放锁；而zk的话，因为创建的是临时znode，只要客户端挂了，znode就没了，此时就自动释放锁\n\nredis分布式锁大家每发现好麻烦吗？遍历上锁，计算时间等等。。。zk的分布式锁语义清晰实现简单\n\n所以先不分析太多的东西，就说这两点，我个人实践认为zk的分布式锁比redis的分布式锁牢靠、而且模型简单易用\n\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br"),e("span",{staticClass:"line-number"},[s._v("132")]),e("br"),e("span",{staticClass:"line-number"},[s._v("133")]),e("br"),e("span",{staticClass:"line-number"},[s._v("134")]),e("br"),e("span",{staticClass:"line-number"},[s._v("135")]),e("br"),e("span",{staticClass:"line-number"},[s._v("136")]),e("br"),e("span",{staticClass:"line-number"},[s._v("137")]),e("br"),e("span",{staticClass:"line-number"},[s._v("138")]),e("br"),e("span",{staticClass:"line-number"},[s._v("139")]),e("br"),e("span",{staticClass:"line-number"},[s._v("140")]),e("br"),e("span",{staticClass:"line-number"},[s._v("141")]),e("br"),e("span",{staticClass:"line-number"},[s._v("142")]),e("br"),e("span",{staticClass:"line-number"},[s._v("143")]),e("br"),e("span",{staticClass:"line-number"},[s._v("144")]),e("br"),e("span",{staticClass:"line-number"},[s._v("145")]),e("br"),e("span",{staticClass:"line-number"},[s._v("146")]),e("br"),e("span",{staticClass:"line-number"},[s._v("147")]),e("br"),e("span",{staticClass:"line-number"},[s._v("148")]),e("br"),e("span",{staticClass:"line-number"},[s._v("149")]),e("br"),e("span",{staticClass:"line-number"},[s._v("150")]),e("br"),e("span",{staticClass:"line-number"},[s._v("151")]),e("br"),e("span",{staticClass:"line-number"},[s._v("152")]),e("br"),e("span",{staticClass:"line-number"},[s._v("153")]),e("br")])]),e("p",[e("strong",[s._v("redis最普通的分布式锁的实现原理")])]),s._v(" "),e("p",[e("img",{attrs:{src:t(5278),alt:"1625500798683"}})]),s._v(" "),e("p",[e("strong",[s._v("RedLock算法的分布式锁")])]),s._v(" "),e("p",[e("img",{attrs:{src:t(5279),alt:"1625501218987"}})]),s._v(" "),e("p",[e("strong",[s._v("zookeeper分布式锁场景")])]),s._v(" "),e("p",[e("img",{attrs:{src:t(5280),alt:"1625501465050"}})]),s._v(" "),e("p",[e("strong",[s._v("zookeeper分布式锁原理")])]),s._v(" "),e("p",[e("img",{attrs:{src:t(5281),alt:"1625501499679"}})]),s._v(" "),e("h4",{attrs:{id:"_4-补充-临时顺序节点实现分布式锁的思想"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_4-补充-临时顺序节点实现分布式锁的思想"}},[s._v("#")]),s._v(" 4.补充：临时顺序节点实现分布式锁的思想")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('public class ZooKeeperDistributedLock implements Watcher{\n\t\n    private ZooKeeper zk;\n    private String locksRoot= "/locks";\n    private String productId;\n    private String waitNode;\n    private String lockNode;\n    private CountDownLatch latch;\n    private CountDownLatch connectedLatch = new CountDownLatch(1);\nprivate int sessionTimeout = 30000; \n\n    public ZooKeeperDistributedLock(String productId){\n        this.productId = productId;\n         try {\n\t   String address = "192.168.31.187:2181,192.168.31.19:2181,192.168.31.227:2181";\n            zk = new ZooKeeper(address, sessionTimeout, this);\n            connectedLatch.await();\n        } catch (IOException e) {\n            throw new LockException(e);\n        } catch (KeeperException e) {\n            throw new LockException(e);\n        } catch (InterruptedException e) {\n            throw new LockException(e);\n        }\n    }\n\n    public void process(WatchedEvent event) {\n        if(event.getState()==KeeperState.SyncConnected){\n            connectedLatch.countDown();\n            return;\n        }\n\n        if(this.latch != null) {  \n            this.latch.countDown(); \n        }\n    }\n\n    public void acquireDistributedLock() {   \n        try {\n            if(this.tryLock()){\n                return;\n            }\n            else{\n                waitForLock(waitNode, sessionTimeout);\n            }\n        } catch (KeeperException e) {\n            throw new LockException(e);\n        } catch (InterruptedException e) {\n            throw new LockException(e);\n        } \n}\n\n    public boolean tryLock() {\n        try {\n \t\t// 传入进去的locksRoot + “/” + productId\n\t\t// 假设productId代表了一个商品id，比如说1\n\t\t// locksRoot = locks\n\t\t// /locks/10000000000，/locks/10000000001，/locks/10000000002\n            lockNode = zk.create(locksRoot + "/" + productId, new byte[0], ZooDefs.Ids.OPEN_ACL_UNSAFE, CreateMode.EPHEMERAL_SEQUENTIAL);\n   \n            // 看看刚创建的节点是不是最小的节点\n\t \t// locks：10000000000，10000000001，10000000002\n            List<String> locks = zk.getChildren(locksRoot, false);\n            Collections.sort(locks);\n\t\n            if(lockNode.equals(locksRoot+"/"+ locks.get(0))){\n                //如果是最小的节点,则表示取得锁\n                return true;\n            }\n\t\n            //如果不是最小的节点，找到比自己小1的节点\n\t  int previousLockIndex = -1;\n            for(int i = 0; i < locks.size(); i++) {\n\t\tif(lockNode.equals(locksRoot + “/” + locks.get(i))) {\n\t         \t    previousLockIndex = i - 1;\n\t\t    break;\n\t\t}\n\t   }\n\t   \n\t   this.waitNode = locks.get(previousLockIndex);\n        } catch (KeeperException e) {\n            throw new LockException(e);\n        } catch (InterruptedException e) {\n            throw new LockException(e);\n        }\n        return false;\n    }\n     \n    private boolean waitForLock(String waitNode, long waitTime) throws InterruptedException, KeeperException {\n        Stat stat = zk.exists(locksRoot + "/" + waitNode, true);\n        if(stat != null){\n            this.latch = new CountDownLatch(1);\n            this.latch.await(waitTime, TimeUnit.MILLISECONDS);            \t   this.latch = null;\n        }\n        return true;\n}\n\n    public void unlock() {\n        try {\n\t\t// 删除/locks/10000000000节点\n\t\t// 删除/locks/10000000001节点\n            System.out.println("unlock " + lockNode);\n            zk.delete(lockNode,-1);\n            lockNode = null;\n            zk.close();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } catch (KeeperException e) {\n            e.printStackTrace();\n        }\n}\n\n    public class LockException extends RuntimeException {\n        private static final long serialVersionUID = 1L;\n        public LockException(String e){\n            super(e);\n        }\n        public LockException(Exception e){\n            super(e);\n        }\n}\n\n// 如果有一把锁，被多个人给竞争，此时多个人会排队，第一个拿到锁的人会执行，然后释放锁，后面的每个人都会去监听排在自己前面的那个人创建的node上，一旦某个人释放了锁，排在自己后面的人就会被zookeeper给通知，一旦被通知了之后，就ok了，自己就获取到了锁，就可以执行代码了\n\n}  \n\n\n\n\n\n\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br"),e("span",{staticClass:"line-number"},[s._v("46")]),e("br"),e("span",{staticClass:"line-number"},[s._v("47")]),e("br"),e("span",{staticClass:"line-number"},[s._v("48")]),e("br"),e("span",{staticClass:"line-number"},[s._v("49")]),e("br"),e("span",{staticClass:"line-number"},[s._v("50")]),e("br"),e("span",{staticClass:"line-number"},[s._v("51")]),e("br"),e("span",{staticClass:"line-number"},[s._v("52")]),e("br"),e("span",{staticClass:"line-number"},[s._v("53")]),e("br"),e("span",{staticClass:"line-number"},[s._v("54")]),e("br"),e("span",{staticClass:"line-number"},[s._v("55")]),e("br"),e("span",{staticClass:"line-number"},[s._v("56")]),e("br"),e("span",{staticClass:"line-number"},[s._v("57")]),e("br"),e("span",{staticClass:"line-number"},[s._v("58")]),e("br"),e("span",{staticClass:"line-number"},[s._v("59")]),e("br"),e("span",{staticClass:"line-number"},[s._v("60")]),e("br"),e("span",{staticClass:"line-number"},[s._v("61")]),e("br"),e("span",{staticClass:"line-number"},[s._v("62")]),e("br"),e("span",{staticClass:"line-number"},[s._v("63")]),e("br"),e("span",{staticClass:"line-number"},[s._v("64")]),e("br"),e("span",{staticClass:"line-number"},[s._v("65")]),e("br"),e("span",{staticClass:"line-number"},[s._v("66")]),e("br"),e("span",{staticClass:"line-number"},[s._v("67")]),e("br"),e("span",{staticClass:"line-number"},[s._v("68")]),e("br"),e("span",{staticClass:"line-number"},[s._v("69")]),e("br"),e("span",{staticClass:"line-number"},[s._v("70")]),e("br"),e("span",{staticClass:"line-number"},[s._v("71")]),e("br"),e("span",{staticClass:"line-number"},[s._v("72")]),e("br"),e("span",{staticClass:"line-number"},[s._v("73")]),e("br"),e("span",{staticClass:"line-number"},[s._v("74")]),e("br"),e("span",{staticClass:"line-number"},[s._v("75")]),e("br"),e("span",{staticClass:"line-number"},[s._v("76")]),e("br"),e("span",{staticClass:"line-number"},[s._v("77")]),e("br"),e("span",{staticClass:"line-number"},[s._v("78")]),e("br"),e("span",{staticClass:"line-number"},[s._v("79")]),e("br"),e("span",{staticClass:"line-number"},[s._v("80")]),e("br"),e("span",{staticClass:"line-number"},[s._v("81")]),e("br"),e("span",{staticClass:"line-number"},[s._v("82")]),e("br"),e("span",{staticClass:"line-number"},[s._v("83")]),e("br"),e("span",{staticClass:"line-number"},[s._v("84")]),e("br"),e("span",{staticClass:"line-number"},[s._v("85")]),e("br"),e("span",{staticClass:"line-number"},[s._v("86")]),e("br"),e("span",{staticClass:"line-number"},[s._v("87")]),e("br"),e("span",{staticClass:"line-number"},[s._v("88")]),e("br"),e("span",{staticClass:"line-number"},[s._v("89")]),e("br"),e("span",{staticClass:"line-number"},[s._v("90")]),e("br"),e("span",{staticClass:"line-number"},[s._v("91")]),e("br"),e("span",{staticClass:"line-number"},[s._v("92")]),e("br"),e("span",{staticClass:"line-number"},[s._v("93")]),e("br"),e("span",{staticClass:"line-number"},[s._v("94")]),e("br"),e("span",{staticClass:"line-number"},[s._v("95")]),e("br"),e("span",{staticClass:"line-number"},[s._v("96")]),e("br"),e("span",{staticClass:"line-number"},[s._v("97")]),e("br"),e("span",{staticClass:"line-number"},[s._v("98")]),e("br"),e("span",{staticClass:"line-number"},[s._v("99")]),e("br"),e("span",{staticClass:"line-number"},[s._v("100")]),e("br"),e("span",{staticClass:"line-number"},[s._v("101")]),e("br"),e("span",{staticClass:"line-number"},[s._v("102")]),e("br"),e("span",{staticClass:"line-number"},[s._v("103")]),e("br"),e("span",{staticClass:"line-number"},[s._v("104")]),e("br"),e("span",{staticClass:"line-number"},[s._v("105")]),e("br"),e("span",{staticClass:"line-number"},[s._v("106")]),e("br"),e("span",{staticClass:"line-number"},[s._v("107")]),e("br"),e("span",{staticClass:"line-number"},[s._v("108")]),e("br"),e("span",{staticClass:"line-number"},[s._v("109")]),e("br"),e("span",{staticClass:"line-number"},[s._v("110")]),e("br"),e("span",{staticClass:"line-number"},[s._v("111")]),e("br"),e("span",{staticClass:"line-number"},[s._v("112")]),e("br"),e("span",{staticClass:"line-number"},[s._v("113")]),e("br"),e("span",{staticClass:"line-number"},[s._v("114")]),e("br"),e("span",{staticClass:"line-number"},[s._v("115")]),e("br"),e("span",{staticClass:"line-number"},[s._v("116")]),e("br"),e("span",{staticClass:"line-number"},[s._v("117")]),e("br"),e("span",{staticClass:"line-number"},[s._v("118")]),e("br"),e("span",{staticClass:"line-number"},[s._v("119")]),e("br"),e("span",{staticClass:"line-number"},[s._v("120")]),e("br"),e("span",{staticClass:"line-number"},[s._v("121")]),e("br"),e("span",{staticClass:"line-number"},[s._v("122")]),e("br"),e("span",{staticClass:"line-number"},[s._v("123")]),e("br"),e("span",{staticClass:"line-number"},[s._v("124")]),e("br"),e("span",{staticClass:"line-number"},[s._v("125")]),e("br"),e("span",{staticClass:"line-number"},[s._v("126")]),e("br"),e("span",{staticClass:"line-number"},[s._v("127")]),e("br"),e("span",{staticClass:"line-number"},[s._v("128")]),e("br"),e("span",{staticClass:"line-number"},[s._v("129")]),e("br"),e("span",{staticClass:"line-number"},[s._v("130")]),e("br"),e("span",{staticClass:"line-number"},[s._v("131")]),e("br")])])])}),[],!1,null,null,null);n.default=a.exports}}]);