(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{1931:function(t,s,p){t.exports=p.p+"assets/img/1638842198182.ed09339d.png"},1932:function(t,s,p){t.exports=p.p+"assets/img/1638843705999.f8a52364.png"},1933:function(t,s,p){t.exports=p.p+"assets/img/1638844185615.2b93919a.png"},1934:function(t,s,p){t.exports=p.p+"assets/img/1638844214969.54b420ce.png"},1935:function(t,s,p){t.exports=p.p+"assets/img/1638843984531.5831f0bb.png"},1936:function(t,s,p){t.exports=p.p+"assets/img/1638844056788.25128562.png"},1937:function(t,s,p){t.exports=p.p+"assets/img/1638844104319.128c7228.png"},1938:function(t,s,p){t.exports=p.p+"assets/img/1638844267401.76187b0e.png"},1939:function(t,s,p){t.exports=p.p+"assets/img/1638844702865.0f1fec94.png"},1940:function(t,s,p){t.exports=p.p+"assets/img/1638844734982.c02c887e.png"},1941:function(t,s,p){t.exports=p.p+"assets/img/1638844777984.1eee9918.png"},1942:function(t,s,p){t.exports=p.p+"assets/img/1638844856920.e32b1551.png"},1943:function(t,s,p){t.exports=p.p+"assets/img/1638845278671.829dc0aa.png"},1944:function(t,s,p){t.exports=p.p+"assets/img/1638845689685.d699714b.png"},1945:function(t,s,p){t.exports=p.p+"assets/img/1638845790324.d3c6c226.png"},1946:function(t,s,p){t.exports=p.p+"assets/img/1638845879742.d0fa36d7.png"},1947:function(t,s,p){t.exports=p.p+"assets/img/1638846089334.0469a95b.png"},1948:function(t,s,p){t.exports=p.p+"assets/img/1638846190983.5e0f6d3e.png"},1949:function(t,s,p){t.exports=p.p+"assets/img/1638846293704.0192413f.png"},1950:function(t,s,p){t.exports=p.p+"assets/img/1638846622719.e4831a7d.png"},1951:function(t,s,p){t.exports=p.p+"assets/img/1638846924845.5330fe10.png"},1952:function(t,s,p){t.exports=p.p+"assets/img/1638856621708.67800233.png"},1953:function(t,s,p){t.exports=p.p+"assets/img/1638857583683.821da4ce.png"},1954:function(t,s,p){t.exports=p.p+"assets/img/1638857619830.d25e0d9d.png"},1955:function(t,s,p){t.exports=p.p+"assets/img/1638857884499.a5c529ee.png"},1956:function(t,s,p){t.exports=p.p+"assets/img/1638858087974.ac027e49.png"},1957:function(t,s,p){t.exports=p.p+"assets/img/1638859463653.5300ad01.png"},8376:function(t,s,p){"use strict";p.r(s);var a=p(5),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_17-权限列表-删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_17-权限列表-删除"}},[t._v("#")]),t._v(" 17.权限列表-删除")]),t._v(" "),a("p",[t._v("我们之前已经完成到这个权限列表展示完成了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1931),alt:"1638842198182"}})]),t._v(" "),a("p",[t._v("我们现在需要做一下权限列表的删除功能---而且这个删除功能是联动的，如果删除掉那么在菜单显示中是要去除掉这个权限的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1932),alt:"1638843705999"}})]),t._v(" "),a("p",[t._v("我们现在需要绑定一个事件--然后弹出一个确认框")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1933),alt:"1638844185615"}})]),t._v(" "),a("p",[t._v("创建confirm这个函数")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1934),alt:"1638844214969"}})]),t._v(" "),a("p",[t._v("然后到文档库中--找一下确认框")]),t._v(" "),a("p",[t._v("​\t有气泡框")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1935),alt:"1638843984531"}})]),t._v(" "),a("p",[t._v("对话框--我们使用对话框比较合适")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1936),alt:"1638844056788"}})]),t._v(" "),a("p",[a("img",{attrs:{src:p(1937),alt:"1638844104319"}})]),t._v(" "),a("p",[t._v("我们现在查看一下页面的效果：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1938),alt:"1638844267401"}})]),t._v(" "),a("p",[t._v("我们现在需要的是要删除那条数据呢？")]),t._v(" "),a("p",[t._v("我们在Table组件中使用形参item来接收到的就是整个对象，如果传的是key字段的那就是一个字段")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1939),alt:"1638844702865"}})]),t._v(" "),a("p",[a("img",{attrs:{src:p(1940),alt:"1638844734982"}})]),t._v(" "),a("p",[t._v("删除的方法：deleteMethod")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1941),alt:"1638844777984"}})]),t._v(" "),a("p",[t._v("页面查看控制台输出：可以拿到整个对象")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1942),alt:"1638844856920"}})]),t._v(" "),a("p",[t._v("当我们点击确认删除的时候，当前页面是需要同步状态，并且后端需要同步数据")]),t._v(" "),a("p",[t._v("现在我们怎么做删除后在列表立即消失呢？")]),t._v(" "),a("p",[t._v("​\t我们将DataSource的状态设置一下，注意React中不让设置原状态，所以我们使用filter来处理，使用filter他不影响原来的数组，而且可以把我们需要的给过滤出来")]),t._v(" "),a("p",[t._v("​\t\t代码中的逻辑就是过滤id不等于item的id的全部数据")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1943),alt:"1638845278671"}})]),t._v(" "),a("p",[t._v("重新设置数据后，会触发重新render渲染")]),t._v(" "),a("p",[t._v("点击删除首页--点击确认---首页在列表中消失了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1944),alt:"1638845689685"}})]),t._v(" "),a("p",[t._v("然后我们需要将后端的数据也进行删除才是真实的删除")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1945),alt:"1638845790324"}})]),t._v(" "),a("p",[t._v("加上这个后端删除后查看页面效果：点击删除首页-首页在列表中和菜单中都没有了，刷新也没有，真的删除了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1946),alt:"1638845879742"}})]),t._v(" "),a("p",[t._v("发现一个遗留的小问题--目前列表页面的用户管理的子菜单没有了--为什么呢？")]),t._v(" "),a("p",[t._v("​\t\t原因是之前我们写死的将第一个数组中的children设置为空导致的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1947),alt:"1638846089334"}})]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("​\t\t现在我们处理一下这个问题：改为这样 循环一下判断如果 children字段中的长度为0那么就设置问空，说明他没有子菜单")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1948),alt:"1638846190983"}})]),t._v(" "),a("p",[t._v("现在用户管理有子菜单了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1949),alt:"1638846293704"}})]),t._v(" "),a("p",[t._v("我们现在是删除一级菜单没有问题，如果删除二级菜单呢？")]),t._v(" "),a("h4",{attrs:{id:"二级菜单删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二级菜单删除"}},[t._v("#")]),t._v(" 二级菜单删除")]),t._v(" "),a("p",[t._v("我们先点击按钮获取下数据结构看一下")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1950),alt:"1638846622719"}})]),t._v(" "),a("p",[t._v("然后我们想到的删除的解决方案是--先根据他的rightId获取到他的全部的二级菜单，然后在这些全部的二级菜单中排除id为3的数据--这样其实就相当于删除了")]),t._v(" "),a("p",[t._v("​\t\t然后我在给后端发一个删除子菜单的接口请求，就可以把这个子菜单给真实的删除掉了")]),t._v(" "),a("p",[t._v("​\t\tgrade是层级的意思 grade是1为第一层，2就是第二层")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1951),alt:"1638846924845"}})]),t._v(" "),a("p",[t._v("判断grade为1的时候进行1级菜单删除，else进行其他级菜单的删除")]),t._v(" "),a("p",[t._v("​\t\t二级菜单的删除--先获过滤取到一级菜单及全部的二级菜单---》然后第二次过滤就是将二级菜单的id过滤出来并且去掉---然后赋值给list.children")]),t._v(" "),a("p",[t._v("![1638847327792](../../../../.vuepress/public/images/1638847327792.png")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1952),alt:"1638856621708"}})]),t._v(" "),a("p",[t._v("我们测试一下：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1953),alt:"1638857583683"}})]),t._v(" "),a("p",[t._v("children里面就少了 删除用户这一项")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1954),alt:"1638857619830"}})]),t._v(" "),a("p",[t._v("我们重新设置dataSource，因为datasource的值已经发生了改变")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1955),alt:"1638857884499"}})]),t._v(" "),a("p",[t._v("我们发现重新设置值后页面没有反应")]),t._v(" "),a("p",[t._v("那我们使用...DataSource这样的话,相当于重新展开赋值一下")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1956),alt:"1638858087974"}})]),t._v(" "),a("p",[t._v("然后我们把后端的数据请求接口删除掉")]),t._v(" "),a("p",[a("img",{attrs:{src:p(1957),alt:"1638859463653"}})]),t._v(" "),a("p",[t._v("https://www.bilibili.com/video/BV13v411H74b?p=18 这节课程比较重点")])])}),[],!1,null,null,null);s.default=e.exports}}]);