(window.webpackJsonp=window.webpackJsonp||[]).push([[252],{7449:function(s,a,e){s.exports=e.p+"assets/img/image-20220425224716660.9a6044b7.png"},7450:function(s,a,e){s.exports=e.p+"assets/img/image-20220425224918507.8c4cf57a.png"},7451:function(s,a,e){s.exports=e.p+"assets/img/1650952499033.902c4c8a.png"},7452:function(s,a,e){s.exports=e.p+"assets/img/image-20220425233330247.b1998db2.png"},7453:function(s,a,e){s.exports=e.p+"assets/img/image-20220425233609839.edece49b.png"},7454:function(s,a,e){s.exports=e.p+"assets/img/image-20220425233722637.814b0fa9.png"},7455:function(s,a,e){s.exports=e.p+"assets/img/image-20220425233831252.29d581e9.png"},7456:function(s,a,e){s.exports=e.p+"assets/img/image-20220425234012872.ace7c944.png"},7457:function(s,a,e){s.exports=e.p+"assets/img/image-20220425234048447.23a70bbb.png"},7458:function(s,a,e){s.exports=e.p+"assets/img/image-20220425234342832.55aac1ae.png"},7459:function(s,a,e){s.exports=e.p+"assets/img/image-20220425234905302.86a07458.png"},7460:function(s,a,e){s.exports=e.p+"assets/img/image-20220425235032652.19764b88.png"},8934:function(s,a,e){"use strict";e.r(a);var t=e(5),n=Object(t.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"_23-k8s核心实战-deployment多副本的能力"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_23-k8s核心实战-deployment多副本的能力"}},[s._v("#")]),s._v(" 23.k8s核心实战-deployment多副本的能力")]),s._v(" "),t("p",[s._v("​\t使用deployment部署的应用是拥有自愈能力的，如果deployment发现pod宕机或者是被删除就会重新启动一个pod。")]),s._v(" "),t("p",[s._v("​\t如果我们真的想删除掉这个pod怎么办？因为我们是使用deploy部署的，所以还是需要使用deploy来删除的，"),t("code",[s._v("kubectl get deploy")]),s._v("查看deploy，然后使用kubectl delete deploye mytomcat 就删除掉了，我们把这个deploye删除这个pod才会真正的删除")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7449),alt:"image-20220425224716660"}})]),s._v(" "),t("p",[t("img",{attrs:{src:e(7450),alt:"image-20220425224918507"}})]),s._v(" "),t("h4",{attrs:{id:"多副本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#多副本"}},[s._v("#")]),s._v(" 多副本")]),s._v(" "),t("p",[s._v("​\t我们现在看一下deployment的另外一个能力，比如订单服务，在一台机器上肯定不行，我们需要多台机器同时部署，多个副本的进行")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7451),alt:"1650952499033"}})]),s._v(" "),t("p",[s._v("​\t我们使用以下命令进行多副本的部署 my-dev是部署的名称，image是指定的镜像，replicas是副本数量")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("kubectl create deployment my-dep --image"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("nginx --replicas"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[t("img",{attrs:{src:e(7452),alt:"image-20220425233330247"}})]),s._v(" "),t("p",[s._v("​\t0/3代表我这个deploy有3个pod，但是有0个启动成功")]),s._v(" "),t("p",[s._v("我们在可视化界面也是可以看到我们的deploy部署的内容")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7453),alt:"image-20220425233609839"}})]),s._v(" "),t("p",[s._v("​\t如果我们想在可视化界面删除掉这个deploy，点击删除按钮就OK了")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7454),alt:"image-20220425233722637"}})]),s._v(" "),t("p",[s._v("如果在我们可视化界面如何创建一个多副本的应用，我们点击+号创建")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7455),alt:"image-20220425233831252"}})]),s._v(" "),t("p",[s._v("然后我们使用表单创建--然后填写应用名称-容器镜像，pod数量")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7456),alt:"image-20220425234012872"}})]),s._v(" "),t("p",[s._v("还没有完全启动起来")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7457),alt:"image-20220425234048447"}})]),s._v(" "),t("p",[s._v("我们使用命令查看一下：可以看到启动了5个pod，分别分配了5个IP地址，部署的节点由k8s进行的分配")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7458),alt:"image-20220425234342832"}})]),s._v(" "),t("h4",{attrs:{id:"使用配置文件进行多副本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用配置文件进行多副本操作"}},[s._v("#")]),s._v(" 使用配置文件进行多副本操作")]),s._v(" "),t("p",[s._v("​\t我们使用命令的方式，还可以使用可视化的表单方式，还可以使用配置文件的方式")]),s._v(" "),t("p",[s._v("​\t配置文件的核心就是 replicas参数，还有就是image参数")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("apiVersion: apps/v1\nkind: Deployment\nmetadata:\n  labels:\n    app: my-dep\n  name: my-dep\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: my-dep\n  template:\n    metadata:\n      labels:\n        app: my-dep\n    spec:\n      containers:\n      - image: nginx\n        name: nginx\n        \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("p",[s._v("点击上传")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7459),alt:"image-20220425234905302"}})]),s._v(" "),t("p",[s._v("我们看到这个是我们使用文件部署的")]),s._v(" "),t("p",[t("img",{attrs:{src:e(7460),alt:"image-20220425235032652"}})])])}),[],!1,null,null,null);a.default=n.exports}}]);