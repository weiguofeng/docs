(window.webpackJsonp=window.webpackJsonp||[]).push([[603],{1337:function(a,t,s){a.exports=s.p+"assets/img/1630035208809.1dc9cd0b.png"},1338:function(a,t,s){a.exports=s.p+"assets/img/1630035221096.0e829f58.png"},8348:function(a,t,s){"use strict";s.r(t);var n=s(5),e=Object(n.a)({},(function(){var a=this,t=a.$createElement,n=a._self._c||t;return n("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[n("h1",{attrs:{id:"_2-springdata-jpa进阶"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-springdata-jpa进阶"}},[a._v("#")]),a._v(" 2.springdata-JPA进阶")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("前言\n时隔一月，夏日渐离，秋风起兮，气温渐凉下，断更者忽觉不妥，似有事相忘，却不得要领，夜深，作罢，而转入被中，方得温暖，正欲入眠，忽闻窗外歌声，唱曰：断更有脸，鸽者无罪。吾大怒：谁断更啊？程序员的事，那能叫断更吗？\n\n咕咕咕~\n\n上一节我们讲解了spring-data-jpa最基础的架构和最简单的增删查改的实现，可以发现spring-data-jpa在简单增删查改的实现是非常友好的，甚至根本见不着sql语句的存在，让人直呼NB。\n\n还记得上一节埋的几个坑吗，这一节就先把坑填了。\n\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br")])]),n("h4",{attrs:{id:"填坑1-实体类的逐渐生成策略详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#填坑1-实体类的逐渐生成策略详解"}},[a._v("#")]),a._v(" 填坑1：实体类的逐渐生成策略详解")]),a._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[a._v("\t上一节讲到实体类时，介绍了很多注解的作用及其属性，举的例子是Oracle数据库的实体类。\n\t\n\t我们知道，Oracle数据库的主键不是自增的，而是依靠序列来实现主键增长，要想实现一个表的主键是自增长的，我们首先要新建一个此表的序列，让他从1开始（或者从你想要的数字开始），每次调用都让序列+1，那么也就实现了主键的自增长了。\n\t\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br")])]),n("p",[a._v("上一节Oracle的主键自增长的主键是这样的：")]),a._v(" "),n("h4",{attrs:{id:"_1-oracle自增长主键策略-generationtype-sequence"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-oracle自增长主键策略-generationtype-sequence"}},[a._v("#")]),a._v(" 1.Oracle自增长主键策略：GenerationType.SEQUENCE")]),a._v(" "),n("p",[n("strong",[a._v("使用如下:")])]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Id")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@GeneratedValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GenerationType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("SEQUENCE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" generator "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"JPA_USER_S"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@SequenceGenerator")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("sequenceName "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"JPA_USER_S"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"JPA_USER_S"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" allocationSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br")])]),n("p",[a._v("解释一下这几个注解如何理解：")]),a._v(" "),n("ul",[n("li",[a._v("当生成策略为SEQUENCE时，@GeneratedValue要配合@SequenceGenerator使用\n"),n("ul",[n("li",[a._v("首先@Id代表它下方的属性是实体类主键属性，也就是数据库的主键")]),a._v(" "),n("li",[a._v('其次@Colum(name = "ID")代表此实体类属性对应的数据库的列名是什么，需要进行关系映射')])])]),a._v(" "),n("li",[a._v('再看@SequenceGenerator(sequenceName = "JPA_USER_S", name = "JPA_USER_S" ,allocationSize = 1),它代表着需要从数据库找到一个序列并在java中映射\n'),n("ul",[n("li",[a._v("sequenceName属性值：数据库中的序列名\n"),n("ul",[n("li",[a._v("name属性值：这个序列名在java中要映射成的名字")]),a._v(" "),n("li",[a._v("allocationSize属性值：这个序列的自增长步长是几")])])])])]),a._v(" "),n("li",[a._v("最后看"),n("code",[a._v('@GeneratedValue(strategy = GenerationType.SEQUENCE, generator = "JPA_USER_S")')]),a._v("，它代表着这个主键采取什么样的生成策略。\n"),n("ul",[n("li",[n("code",[a._v("strategy")]),a._v("属性值：采取的主键策略是什么")]),a._v(" "),n("li",[n("code",[a._v("generator")]),a._v("属性值：使用的序列的映射名是什么，这个映射名就是"),n("code",[a._v("@SequenceGenerator")]),a._v("中"),n("code",[a._v("name")]),a._v("的值")])])])]),a._v(" "),n("p",[a._v("从上到下理解后有没有理顺这几个注解的先后呢？尤其是"),n("code",[a._v("@SequenceGenerator")]),a._v("和"),n("code",[a._v("@GeneratedValue")]),a._v("的关系。")]),a._v(" "),n("p",[n("strong",[a._v("至此oracle的主键策略注解才算基本讲完，然而并没有结束！")])]),a._v(" "),n("p",[a._v("我们知道以序列作为自增长的数据库有"),n("code",[a._v("Oracle、PostgreSQL、DB2")]),a._v("，不过还有一个耳熟能详的数据库"),n("code",[a._v("Mysql")]),a._v("是可以不需要序列，直接定义主键自增长的，那么它就需要另一种生成策略。")]),a._v(" "),n("h4",{attrs:{id:"_2-mysql自增长主键策略-generationtype-identity"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-mysql自增长主键策略-generationtype-identity"}},[a._v("#")]),a._v(" 2.MySQL自增长主键策略：GenerationType.IDENTITY")]),a._v(" "),n("p",[a._v("使用如下：")]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Id")]),a._v("  \n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@GeneratedValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GenerationType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("IDENTITY"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("  \n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("p",[a._v("解释一下")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[a._v("- 当生成策略为IDENTITY时，@GeneratedValue单独使用\n- @GeneratedValue(strategy = GenerationType.IDENTITY),只需要这一个注解就可以实现Mysql的主键自动增长，我们知道MySql建表的时候可以给主键声明，auto_increment,这就实现了自增长了，所以注解也相对简单。\n")])])]),n("p",[a._v("在"),n("code",[a._v("@GeneratedValue")]),a._v("注解中我们只需要生成策略为"),n("code",[a._v("IDENTITY")]),a._v("，即可完成mysql数据库的主键自增长。")]),a._v(" "),n("h4",{attrs:{id:"_3-万能自增长主键策略-generationtype-table"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-万能自增长主键策略-generationtype-table"}},[a._v("#")]),a._v(" 3.万能自增长主键策略：GenerationType.TABLE")]),a._v(" "),n("p",[a._v("使用如下：")]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[a._v("    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Id")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@GeneratedValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GenerationType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("TABLE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" generator "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_table"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@TableGenerator")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_table"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                    allocationSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                    table "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_table"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                    pkColumnName "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                    valueColumnName "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_count"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br")])]),n("p",[a._v("解释一下：")]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[a._v("- 当生成策略为TABLE时，@GeneratedValue要配合@TableGenerator使用\n")])])]),n("ul",[n("li",[a._v('@TableGenerator(name = "id_sequence", allocationSize = 1, table = "sequence_table",pkColumnName = "sequence_max_id", valueColumnName = "sequence_count")，它代表着需要在数据库建立一张索引表来帮助我们实现主键自增\n'),n("ul",[n("li",[a._v("name属性值：建立的索引表在java中要映射的名字\n"),n("ul",[n("li",[a._v("allocationSize属性值：这个序列的自增步长是几")]),a._v(" "),n("li",[a._v("table属性值：建立的序列表的表名，缺省值：SEQUENCE\n"),n("ul",[n("li",[n("code",[a._v("pkColumnName")]),a._v("属性值: 建立的序列表的第一个列的列名，此列自动填充需要序列作为主键自增长的表的表名，缺省值：SEQ_NAME")])])])])])])]),a._v(" "),n("li",[a._v('@GeneratedValue(strategy = GenerationType.TABLE, generator = "id_sequence"),代表着这个主键采取什么样的生成策略，和Oracle中的解释一样\n'),n("ul",[n("li",[n("code",[a._v("strategy")]),a._v("属性值：采取的主键策略是什么")]),a._v(" "),n("li",[n("code",[a._v("generator")]),a._v("属性值：使用的映射名是什么，这个映射名就是"),n("code",[a._v("@SequenceGenerator")]),a._v("中"),n("code",[a._v("name")]),a._v("的值")])])])]),a._v(" "),n("p",[a._v("一通解释看下来，可能会有点蒙，用示例来解释会更加直观：")]),a._v(" "),n("h3",{attrs:{id:"table生成策略示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#table生成策略示例"}},[a._v("#")]),a._v(" TABLE生成策略示例：")]),a._v(" "),n("p",[n("strong",[a._v("3.1 新建一个部门实体类：JpaDepartment（属性很简单：id、部门名、五个系统字段）")])]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Data")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Entity")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Table")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"JPA_DEPARTMENT"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@EntityListeners")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AuditingEntityListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("JpaDepartment")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Id")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@GeneratedValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GenerationType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("TABLE"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" generator "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_table"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@TableGenerator")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_table"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                    allocationSize "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                    table "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_table"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                    pkColumnName "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_name"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                    valueColumnName "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sequence_count"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NAME"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"OBJECT_VERSION"')]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Version")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" objectVersion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"CREATED_BY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@CreatedBy")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" createdBy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"CREATED_DATE"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@CreatedDate")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@JsonFormat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("pattern "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"yyyy-MM-dd HH:mm:ss"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" timezone "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"GMT+8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Date")]),a._v(" createdDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"LAST_UPDATED_BY"')]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@LastModifiedBy")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" lastUpdatedBy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"LAST_UPDATED_DATE"')]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@LastModifiedDate")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@JsonFormat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("pattern "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"yyyy-MM-dd HH:mm:ss"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" timezone "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"GMT+8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Date")]),a._v(" lastUpdatedDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\t\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br"),n("span",{staticClass:"line-number"},[a._v("24")]),n("br"),n("span",{staticClass:"line-number"},[a._v("25")]),n("br"),n("span",{staticClass:"line-number"},[a._v("26")]),n("br"),n("span",{staticClass:"line-number"},[a._v("27")]),n("br"),n("span",{staticClass:"line-number"},[a._v("28")]),n("br"),n("span",{staticClass:"line-number"},[a._v("29")]),n("br"),n("span",{staticClass:"line-number"},[a._v("30")]),n("br"),n("span",{staticClass:"line-number"},[a._v("31")]),n("br"),n("span",{staticClass:"line-number"},[a._v("32")]),n("br"),n("span",{staticClass:"line-number"},[a._v("33")]),n("br"),n("span",{staticClass:"line-number"},[a._v("34")]),n("br"),n("span",{staticClass:"line-number"},[a._v("35")]),n("br"),n("span",{staticClass:"line-number"},[a._v("36")]),n("br"),n("span",{staticClass:"line-number"},[a._v("37")]),n("br"),n("span",{staticClass:"line-number"},[a._v("38")]),n("br"),n("span",{staticClass:"line-number"},[a._v("39")]),n("br"),n("span",{staticClass:"line-number"},[a._v("40")]),n("br"),n("span",{staticClass:"line-number"},[a._v("41")]),n("br")])]),n("p",[a._v("**3.2其他的respository，service，controller的代码略过，实现的还是和用户类一样的简单的增删改查 **")]),a._v(" "),n("p",[a._v("这一次我并没有使用sql来新建一张表，仅仅是建立一个实体类，这个时候前面的yml配置就开始发挥他的作用了，我们对jpa的配置如下：")]),a._v(" "),n("div",{staticClass:"language-yaml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-yaml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("jpa")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("hibernate")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("ddl-auto")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" update "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#自动更新")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("show-sql")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v("  "),n("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#日志中显示sql语句")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br")])]),n("p",[n("strong",[a._v("解释一下：")])]),a._v(" "),n("ul",[n("li",[n("p",[a._v("ddl-auto: create:启动时删除上一次生成的表，并根据实体类生成表，表中数据会被清空")])]),a._v(" "),n("li",[n("p",[a._v("ddl-auto: create-drop:启动时根据实体类生成表，程序关闭时表会被删除。")])]),a._v(" "),n("li",[n("p",[a._v("ddl-auto： update：启动时会根据实体类生成表，当实体类属性变动的时候，表结构也会更新，在初期开发阶段使用此选项。")])]),a._v(" "),n("li",[n("p",[a._v("ddl-auto:  validate：启动时验证实体类和数据表是否一致，在数据结构稳定时采用此选项。")])]),a._v(" "),n("li",[n("p",[a._v("ddl-auto: none :不采取任何措施")]),a._v(" "),n("p",[a._v("建议只使用update和none，前者适合初期建表，后者适合建表完成后保护表结构")])]),a._v(" "),n("li",[n("p",[a._v("show-sql :true,这个属性代表是否开启显示sql语句，为 true 我们就可以在每一次对数据库的操作在控制台看到所使用的sql语句了，方便找错，很方便的属性，建议开发时开启，上线后关闭")])])]),a._v(" "),n("p",[n("strong",[a._v("ddl-auto: update时，jpa会根据实体类帮助我们创建表~")])]),a._v(" "),n("p",[n("strong",[a._v("3.3 有了部门实体类JpaDepartment，让我们启动看一下实际效果：")])]),a._v(" "),n("p",[n("strong",[a._v("3.3.1 控制台的输出：")])]),a._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[a._v("Hibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" jpa_department "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("id number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("19")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                                        created_by varchar2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("char")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                                        created_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("timestamp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        last_updated_by varchar2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("char")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        last_updated_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("timestamp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        name varchar2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("char")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        object_version number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("19")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("primary")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("key")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n                                  \nHibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" sequence_table "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("sequence_name varchar2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("char")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sequence_count number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("19")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("primary")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("key")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("sequence_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\nHibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" sequence_table"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("sequence_name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sequence_count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[a._v("'jpa_department'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br")])]),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[a._v("- 1.创建了一张名为jpa_department的表，各个列名皆为实体类属性名，长度取的默认值。\n")])])]),n("ul",[n("li",[a._v("2.创建了一张名为sequence_table序列表（table属性的值），\n"),n("ul",[n("li",[a._v("列名1：pkColumnName的值（sequence_name），代表此行索引值所属表，\n"),n("ul",[n("li",[a._v("列名2：valueColumn的值（sequence_count）,代表下一次插入的索引值（在插入前会提前+1）")])])])])]),a._v(" "),n("li",[a._v("3.根据"),n("code",[a._v("@TableGenerator")]),a._v("所在类映射的表名插入了一行数据，分别为"),n("code",[a._v("('jpa_department',0)")]),a._v("，也就是代表"),n("code",[a._v("jpa_department")]),a._v("这张表下一次插入的索引值是"),n("code",[a._v("1（0+1）")])])]),a._v(" "),n("p",[n("strong",[a._v("3.3.2 借助DateBase工具可以看到表全貌：")])]),a._v(" "),n("p",[n("img",{attrs:{src:s(1337),alt:"1630035208809"}})]),a._v(" "),n("p",[a._v("缺少的表，jpa通过实体类对表的映射补全了。")]),a._v(" "),n("p",[a._v("新增了我们所需的"),n("code",[a._v("JPA_DEPARTMENT")]),a._v("表和一张对主键实现自增长的序列表"),n("code",[a._v("SEQUENCE_TABLE")])]),a._v(" "),n("p",[n("strong",[a._v("3.3.3 进行一次插入操作")])]),a._v(" "),n("p",[a._v("postman")]),a._v(" "),n("p",[n("img",{attrs:{src:s(1338),alt:"1630035221096"}})]),a._v(" "),n("p",[a._v("控制台输出：")]),a._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[a._v("Hibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("select")]),a._v(" tbl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sequence_count "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("from")]),a._v(" sequence_table tbl "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" tbl"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("sequence_name"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("? "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("update")]),a._v("\n\nHibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("update")]),a._v(" sequence_table "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" sequence_count"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("?  "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("where")]),a._v(" sequence_count"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("? "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("and")]),a._v(" sequence_max_id"),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("?\n\nHibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("insert")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("into")]),a._v(" jpa_department "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("created_by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                       created_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                                       last_updated_by"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                       last_updated_date"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                                       name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                                       object_version"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                       id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n                                       "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("values")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("?"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ?"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ?"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ?"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ?"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ?"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" ?"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br")])]),n("p",[a._v("一次插入拥有三条sql语句")]),a._v(" "),n("ul",[n("li",[a._v("1.会等待行锁释放之后，返回"),n("code",[a._v("sequence_table")]),a._v("表的查询结果，返回"),n("code",[a._v("jpa_department")]),a._v("的当前索引值")]),a._v(" "),n("li",[a._v("2.更新操作，把"),n("code",[a._v("sequence_table")]),a._v("表中的"),n("code",[a._v("sequence_count")]),a._v("的值+1")]),a._v(" "),n("li",[a._v("3.把更新后的"),n("code",[a._v("sequence_count")]),a._v("值当成主键值插入到"),n("code",[a._v("jpa_department")]),a._v("表中作为主键值")])]),a._v(" "),n("p",[a._v("在这三条sql语句执行后，显然"),n("code",[a._v("jpa_department")]),a._v("这一次插入的主键值为1，postman返回的json数据也证实了这一点")]),a._v(" "),n("h4",{attrs:{id:"_4-auto自动判断主键策略-缺省策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-auto自动判断主键策略-缺省策略"}},[a._v("#")]),a._v(" 4.AUTO自动判断主键策略（缺省策略）：")]),a._v(" "),n("p",[n("strong",[a._v("使用如下：")])]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[a._v("    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Id")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\t"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@GeneratedValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GenerationType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br")])]),n("p",[n("strong",[a._v("解释一下：")])]),a._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[a._v("- 当生成策略为AUTO时，@GeneratedValue单独使用\n")])])]),n("ul",[n("li",[a._v("@GeneratedValue(strategy = GenerationType.AUTO), JPA会自己从 Table策略、Sequence策略和Identity策略，三种策略中选择合适的主键生成策略。\n"),n("ul",[n("li",[a._v("strategy 属性值：主键生成策略，什么都不写即缺省值即为AUTO")])])])]),a._v(" "),n("h3",{attrs:{id:"auto生成策略示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#auto生成策略示例"}},[a._v("#")]),a._v(" AUTO生成策略示例：")]),a._v(" "),n("p",[a._v("**4.1 仍然使用的是刚刚的部门类JPA_DEPARTMENT，把已创建的表删除，修改生成策略为auto **")]),a._v(" "),n("div",{staticClass:"language-java line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-java"}},[n("code",[n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Data")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Entity")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Table")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"JPA_DEPARTMENT"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@EntityListeners")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("AuditingEntityListener")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("public")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("class")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("JpaDepartment")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Id")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ID"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@GeneratedValue")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("strategy "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("GenerationType")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("AUTO"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"NAME"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" name"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"OBJECT_VERSION"')]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Version")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Long")]),a._v(" objectVersion"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"CREATED_BY"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@CreatedBy")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" createdBy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"CREATED_DATE"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@CreatedDate")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@JsonFormat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("pattern "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"yyyy-MM-dd HH:mm:ss"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" timezone "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"GMT+8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Date")]),a._v(" createdDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"LAST_UPDATED_BY"')]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@LastModifiedBy")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("String")]),a._v(" lastUpdatedBy"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@Column")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("name "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"LAST_UPDATED_DATE"')]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@LastModifiedDate")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token annotation punctuation"}},[a._v("@JsonFormat")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("pattern "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"yyyy-MM-dd HH:mm:ss"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" timezone "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[a._v('"GMT+8"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("private")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Date")]),a._v(" lastUpdatedDate"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br"),n("span",{staticClass:"line-number"},[a._v("11")]),n("br"),n("span",{staticClass:"line-number"},[a._v("12")]),n("br"),n("span",{staticClass:"line-number"},[a._v("13")]),n("br"),n("span",{staticClass:"line-number"},[a._v("14")]),n("br"),n("span",{staticClass:"line-number"},[a._v("15")]),n("br"),n("span",{staticClass:"line-number"},[a._v("16")]),n("br"),n("span",{staticClass:"line-number"},[a._v("17")]),n("br"),n("span",{staticClass:"line-number"},[a._v("18")]),n("br"),n("span",{staticClass:"line-number"},[a._v("19")]),n("br"),n("span",{staticClass:"line-number"},[a._v("20")]),n("br"),n("span",{staticClass:"line-number"},[a._v("21")]),n("br"),n("span",{staticClass:"line-number"},[a._v("22")]),n("br"),n("span",{staticClass:"line-number"},[a._v("23")]),n("br"),n("span",{staticClass:"line-number"},[a._v("24")]),n("br"),n("span",{staticClass:"line-number"},[a._v("25")]),n("br"),n("span",{staticClass:"line-number"},[a._v("26")]),n("br"),n("span",{staticClass:"line-number"},[a._v("27")]),n("br"),n("span",{staticClass:"line-number"},[a._v("28")]),n("br"),n("span",{staticClass:"line-number"},[a._v("29")]),n("br"),n("span",{staticClass:"line-number"},[a._v("30")]),n("br"),n("span",{staticClass:"line-number"},[a._v("31")]),n("br"),n("span",{staticClass:"line-number"},[a._v("32")]),n("br"),n("span",{staticClass:"line-number"},[a._v("33")]),n("br"),n("span",{staticClass:"line-number"},[a._v("34")]),n("br"),n("span",{staticClass:"line-number"},[a._v("35")]),n("br"),n("span",{staticClass:"line-number"},[a._v("36")]),n("br")])]),n("p",[n("strong",[a._v("4.2 运行程序看一下jpa自动帮助我们做了什么")])]),a._v(" "),n("div",{staticClass:"language-sql line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-sql"}},[n("code",[a._v("Hibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("table")]),a._v(" jpa_department "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("id number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("19")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[a._v("not")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("null")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        created_by varchar2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("char")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        created_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("timestamp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        last_updated_by varchar2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("char")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        last_updated_date "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("timestamp")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        name varchar2"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("char")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n                                        object_version number"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("19")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n                                        "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("primary")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("key")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("id"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nHibernate: "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" sequence hibernate_sequence "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("start")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("with")]),a._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" increment "),n("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("by")]),a._v("  "),n("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n\n")])]),a._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[a._v("1")]),n("br"),n("span",{staticClass:"line-number"},[a._v("2")]),n("br"),n("span",{staticClass:"line-number"},[a._v("3")]),n("br"),n("span",{staticClass:"line-number"},[a._v("4")]),n("br"),n("span",{staticClass:"line-number"},[a._v("5")]),n("br"),n("span",{staticClass:"line-number"},[a._v("6")]),n("br"),n("span",{staticClass:"line-number"},[a._v("7")]),n("br"),n("span",{staticClass:"line-number"},[a._v("8")]),n("br"),n("span",{staticClass:"line-number"},[a._v("9")]),n("br"),n("span",{staticClass:"line-number"},[a._v("10")]),n("br")])]),n("div",{staticClass:"language- extra-class"},[n("pre",[n("code",[a._v("- 创建了jpa_department这张表\n- 创建了一个名为hibernate_sequence的序列\n")])])]),n("p",[a._v("显然jpa识别到了我连接的数据库是oracle数据库，所以采取的是SEQUENCE生成策略，它帮助我们建立了一个名为"),n("code",[a._v("hibernate_sequence")]),a._v("的序列，但是这个名字显然是无法一眼看出来是属于谁的序列的，不方便对序列的维护，所以不推荐使用"),n("code",[a._v("auto")]),a._v("策略哦")]),a._v(" "),n("h4",{attrs:{id:"总结-主键策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#总结-主键策略"}},[a._v("#")]),a._v(" 总结-主键策略：")]),a._v(" "),n("p",[a._v("1.主键生成策略分为四种：SEQUENCE策略、IDENTITY策略、TABLE策略、AUTO策略；")]),a._v(" "),n("p",[a._v("2.SEQUENCE策略适合拥有序列的数据库，比如Oracle；")]),a._v(" "),n("p",[a._v("3.IDENTITY策略适合拥有主键自增长的数据库，比如Mysql；")]),a._v(" "),n("p",[a._v("4.TABLE策略是通过一张序列表来维护主键插入的值的，所以适合所有数据库；")]),a._v(" "),n("p",[a._v("5.AUTO策略是jpa自行判断使用上面三个中的哪一个作为主键生成策略；")]),a._v(" "),n("p",[a._v("6.推荐使用SEQUENCE和IDENTITY策略，开发人员应该自行判断使用的是何种数据库，而不是由jpa进行判断。")])])}),[],!1,null,null,null);t.default=e.exports}}]);