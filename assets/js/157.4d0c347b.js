(window.webpackJsonp=window.webpackJsonp||[]).push([[157],{6280:function(t,s,p){t.exports=p.p+"assets/img/1657607149370.f4cef5a5.png"},6281:function(t,s,p){t.exports=p.p+"assets/img/1657607275136.76d3488c.png"},6282:function(t,s,p){t.exports=p.p+"assets/img/1657607467249.ab5ec58c.png"},6283:function(t,s,p){t.exports=p.p+"assets/img/1657607579395.e237cefd.png"},6284:function(t,s,p){t.exports=p.p+"assets/img/1657607734884.7fe0b4ec.png"},6285:function(t,s,p){t.exports=p.p+"assets/img/1657607876243.9457abf7.png"},6286:function(t,s,p){t.exports=p.p+"assets/img/1657608014775.72bf9e85.png"},6287:function(t,s,p){t.exports=p.p+"assets/img/1657608441193.14ecdf61.png"},6288:function(t,s,p){t.exports=p.p+"assets/img/1657609536313.6b67af0e.png"},6289:function(t,s,p){t.exports=p.p+"assets/img/1657609626252.03e7a65e.png"},6290:function(t,s,p){t.exports=p.p+"assets/img/1657609914839.bebd944d.png"},6291:function(t,s,p){t.exports=p.p+"assets/img/1657609997484.c513874b.png"},6292:function(t,s,p){t.exports=p.p+"assets/img/1657610121486.4d6ef6e2.png"},6293:function(t,s,p){t.exports=p.p+"assets/img/1657610361895.24b132b8.png"},6294:function(t,s,p){t.exports=p.p+"assets/img/1657610520321.2c8050e3.png"},6295:function(t,s,p){t.exports=p.p+"assets/img/1657610676882.311594da.png"},6296:function(t,s,p){t.exports=p.p+"assets/img/1657610697491.c00b7640.png"},8835:function(t,s,p){"use strict";p.r(s);var a=p(5),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_18-devops-可视化pipeline-第五步-就绪探针问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_18-devops-可视化pipeline-第五步-就绪探针问题"}},[t._v("#")]),t._v(" 18.devops-可视化Pipeline-第五步-就绪探针问题")]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("​\t\t\t针对前面的编码问题，我们发现每个微服务都有一个bootstrap.properties,这个编码问题会导致中文乱码的问题")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6280),alt:"1657607149370"}})]),t._v(" "),a("p",[t._v("​\t\t所以我们把每个中文乱码的问题都处理了，都删除掉这些中文乱码")]),t._v(" "),a("p",[t._v("​\t还有就是每个微服务都是没有加Nacos配置中心的依赖的，我们现在都加上，这样的话每个微服务就能从Nacos中自己获取自己的生产环境配置了，这样我们的配置 比如redis的地址才能生效")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6281),alt:"1657607275136"}})]),t._v(" "),a("p",[t._v("​\t另外为了调试错误方便，我们在日志中也添加了调试错误的控制台输出日志 CONSOLE")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6282),alt:"1657607467249"}})]),t._v(" "),a("p",[t._v("​\t\t修改后---我们提交代码，然后再次运行流水线")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6283),alt:"1657607579395"}})]),t._v(" "),a("p",[t._v("​\t\t我们还是看一下有些应用容器没有准备就绪，我们进入查看一下日志")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6284),alt:"1657607734884"}})]),t._v(" "),a("p",[t._v("​\t我们进入日志查看--这个task没有问题，应用也启动成功了，那么提示的--容器没有准备就绪的问题就是探针的问题")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6285),alt:"1657607876243"}})]),t._v(" "),a("p",[t._v("​\t然后我们在master节点，请求一下这个容器，测试一下探针，发现status是DOWN")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6286),alt:"1657608014775"}})]),t._v(" "),a("p",[t._v("​\t\t我们查看其它的微服务--发现也是服务都成功的启动没有问题，但是还是--容器没有准备就绪的问题一直都有，原因就是这个探针的状态返回的不对DOWN")]),t._v(" "),a("p",[t._v("​\t\t那么我们在微服务中的Application.yaml中加入managment的暴露*和 暴露详细信息 show-datails：always")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6287),alt:"1657608441193"}})]),t._v(" "),a("p",[t._v("​\t这个配置指的是，当这个健康信息真的是宕机的情况的话，我们就让他展示详细信息")]),t._v(" "),a("p",[t._v("​\t\t这样的话，我们就可以看到他是什么原因宕掉的了")]),t._v(" "),a("p",[t._v("​\t我们在本机随便启动一个微服务---然后我们请求一下健康检查")]),t._v(" "),a("p",[t._v("​\t我们在本机是都是UP，UP没问题")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6288),alt:"1657609536313"}})]),t._v(" "),a("p",[t._v("​\t\t我们在Nacos上，我们给每个微服务都加上这个配置")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6289),alt:"1657609626252"}})]),t._v(" "),a("p",[t._v("​\t\t然后我们现在重新启动一个服务，测试一下他的详细健康信息有没有问题")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6290),alt:"1657609914839"}})]),t._v(" "),a("p",[t._v("​\t\t我们可以看到这个是up")]),t._v(" "),a("p",[t._v("​\t然后这个容器也就就绪好了---没有之前那个提示的--容器没有就绪的提醒了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6291),alt:"1657609997484"}})]),t._v(" "),a("p",[t._v("​\t然后现在我们把每一个 处理超时的警告 的微服务都节点重新启动一下")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6292),alt:"1657610121486"}})]),t._v(" "),a("p",[t._v("​\t我们发现还是会有个别的服务不行---然后我们使用curl请求一下反而就好了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6293),alt:"1657610361895"}})]),t._v(" "),a("p",[t._v("​\t我们这个服务的端口是8203，我们将线上的都使用8080，这个服务端口在Nacos中没有修改")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6294),alt:"1657610520321"}})]),t._v(" "),a("p",[t._v("​\t\t而使用8080端口的服务--我们使用curl请求一下这个服务及端口，发现就变好了，这个现象就很神奇")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6295),alt:"1657610676882"}})]),t._v(" "),a("p",[t._v("​\t\t变为正常了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6296),alt:"1657610697491"}})]),t._v(" "),a("p",[t._v("​\t这就完全正常了")]),t._v(" "),a("p",[t._v("https://www.bilibili.com/video/BV13Q4y1C7hS?p=123&spm_id_from=pageDriver&vd_source=243ad3a9b323313aa1441e5dd414a4ef")]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("​")])])}),[],!1,null,null,null);s.default=e.exports}}]);