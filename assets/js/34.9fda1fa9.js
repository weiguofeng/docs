(window.webpackJsonp=window.webpackJsonp||[]).push([[34],{6860:function(t,s,p){t.exports=p.p+"assets/img/1657611141309.10497983.png"},6861:function(t,s,p){t.exports=p.p+"assets/img/1657611371913.f21c427b.png"},6862:function(t,s,p){t.exports=p.p+"assets/img/1657611515299.2845964c.png"},6863:function(t,s,p){t.exports=p.p+"assets/img/1657611647396.37688517.png"},6864:function(t,s,p){t.exports=p.p+"assets/img/1657611674066.109ff9fe.png"},6865:function(t,s,p){t.exports=p.p+"assets/img/1657611809134.27bbbd57.png"},6866:function(t,s,p){t.exports=p.p+"assets/img/1657611932280.a165bbae.png"},6867:function(t,s,p){t.exports=p.p+"assets/img/1657612032445.7b30fd94.png"},6868:function(t,s,p){t.exports=p.p+"assets/img/1657612066212.0f2fa03a.png"},6869:function(t,s,p){t.exports=p.p+"assets/img/1657612176313.7338f436.png"},6870:function(t,s,p){t.exports=p.p+"assets/img/1657612262868.6d39992b.png"},6871:function(t,s,p){t.exports=p.p+"assets/img/1657612313999.e78150ec.png"},6872:function(t,s,p){t.exports=p.p+"assets/img/1657612377782.b8ac4955.png"},6873:function(t,s,p){t.exports=p.p+"assets/img/1657612447845.6ae9ef74.png"},6874:function(t,s,p){t.exports=p.p+"assets/img/1657612600162.b199c7b2.png"},6875:function(t,s,p){t.exports=p.p+"assets/img/1657612713351.6e40d0f9.png"},6876:function(t,s,p){t.exports=p.p+"assets/img/1657612803966.d04b239b.png"},6877:function(t,s,p){t.exports=p.p+"assets/img/1657612814417.5874b79c.png"},6878:function(t,s,p){t.exports=p.p+"assets/img/1657612848636.78d9cc3e.png"},6879:function(t,s,p){t.exports=p.p+"assets/img/1657612903998.c6a0db93.png"},6880:function(t,s,p){t.exports=p.p+"assets/img/1657612981643.e66664c2.png"},6881:function(t,s,p){t.exports=p.p+"assets/img/1657613131524.83171c65.png"},6882:function(t,s,p){t.exports=p.p+"assets/img/1657613309257.554e4b10.png"},6883:function(t,s,p){t.exports=p.p+"assets/img/1657613361714.eb6729d7.png"},6884:function(t,s,p){t.exports=p.p+"assets/img/1657613643173.43b7ce5a.png"},6885:function(t,s,p){t.exports=p.p+"assets/img/1657613728909.e5078143.png"},6886:function(t,s,p){t.exports=p.p+"assets/img/1657613901519.1eda586c.png"},6887:function(t,s,p){t.exports=p.p+"assets/img/1657613944744.b7fd85cf.png"},6888:function(t,s,p){t.exports=p.p+"assets/img/1657613984326.c74e99a1.png"},6889:function(t,s,p){t.exports=p.p+"assets/img/1657614074875.5d1f2e8c.png"},6890:function(t,s,p){t.exports=p.p+"assets/img/1657614113318.0a5c9802.png"},6891:function(t,s,p){t.exports=p.p+"assets/img/1657614190632.92a2f84a.png"},6892:function(t,s,p){t.exports=p.p+"assets/img/1657614433605.5488cbff.png"},9471:function(t,s,p){"use strict";p.r(s);var a=p(5),v=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_19-devops-可视化pipeline-第六步-系统邮件功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_19-devops-可视化pipeline-第六步-系统邮件功能"}},[t._v("#")]),t._v(" 19.devops-可视化Pipeline-第六步-系统邮件功能")]),t._v(" "),a("p",[t._v("​\t\t我们之前针对微服务在部署期间有些比较奇怪的问题，我们必须把这个微服务先访问一下，然后把他激活了以后，我们的就绪 探针才可以生效")]),t._v(" "),a("p",[t._v("​\t\t而针对于这个问题是我们spring这个低版本，我们使用的是2.2.1的版本")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6860),alt:"1657611141309"}})]),t._v(" "),a("p",[t._v("​\t\t我们更推荐使用springboot的 2.4.* 或者是 2.3.*这样的话，对于我们和k8s的整合就会更好一些")]),t._v(" "),a("p",[t._v("​\t\t在低版本2.2.1中，我们选择把这个就绪探针注掉，这样的话就是下次应用启动成功就是成功了，不用探针探测了，要么还得激活一下，也比较麻烦")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6861),alt:"1657611371913"}})]),t._v(" "),a("p",[t._v("​\t\t\t我们针对于这个奇怪的问题就先这么解决")]),t._v(" "),a("p",[t._v("​\t\t我们现在这些都做完之后，我们再在流水线上扩展一些事情")]),t._v(" "),a("p",[t._v("​\t我们的流水线--在真正做完后，我们期望是在最后的一步--比如人工卡点啊 邮件发送等步骤")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6862),alt:"1657611515299"}})]),t._v(" "),a("p",[t._v("​\t我们现在是加入一个邮件的功能")]),t._v(" "),a("h4",{attrs:{id:"流水线邮件发送功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#流水线邮件发送功能"}},[t._v("#")]),t._v(" 流水线邮件发送功能")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6863),alt:"1657611647396"}})]),t._v(" "),a("p",[t._v("​\t\t选择邮件")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6864),alt:"1657611674066"}})]),t._v(" "),a("p",[t._v("​\t然后填写邮件信息，在body中填写内容，当然在这里也可以使用$符号取出我们之前配置的环境变量的信息")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6865),alt:"1657611809134"}})]),t._v(" "),a("p",[t._v("​\t我们放到本地编辑一下---我们使用构建的次数变量-构建结果")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6866),alt:"1657611932280"}})]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("​\t我们想要发送邮件那么，系统就需要拥有发邮件的功能，需要我们登录到系统中配置一下这个邮件的功能")]),t._v(" "),a("p",[t._v("​\t\t使用admin登录")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6867),alt:"1657612032445"}})]),t._v(" "),a("p",[t._v("​\t然后是平台管理------集群管理，不对，到平台设置中")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6868),alt:"1657612066212"}})]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("​\t\t在这里需要配置邮件服务器的地址，邮件服务器的用户名及密码")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6869),alt:"1657612176313"}})]),t._v(" "),a("p",[t._v("​\t我们进入到网易邮箱的邮件发送服务设置中")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6870),alt:"1657612262868"}})]),t._v(" "),a("p",[t._v("​\t\t我们使用这个SMTP服务器，拷贝smtp.163.com")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6871),alt:"1657612313999"}})]),t._v(" "),a("p",[t._v("​\t\t而账号和密码---我们需要开启一下这个邮件服务")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6872),alt:"1657612377782"}})]),t._v(" "),a("p",[t._v("​\t这个开启后的授权码---其实就是我们登录到邮件服务器的密码")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6873),alt:"1657612447845"}})]),t._v(" "),a("p",[t._v("​\t账户--其实就是我们使用的邮件账户---然后保存--我们的邮件服务就配置好了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6874),alt:"1657612600162"}})]),t._v(" "),a("p",[t._v("​\t\t我们这个配置好了之后---以后我们凡事需要发送邮件的，我们的平台就会以这个邮件服务进行邮件的推送")]),t._v(" "),a("p",[t._v("​\t我们创建一个简单的流水线--专门测试这个邮件的服务")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6875),alt:"1657612713351"}})]),t._v(" "),a("p",[t._v("​\t然后添加一个邮件功能的流水线步骤")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6876),alt:"1657612803966"}})]),t._v(" "),a("p",[a("img",{attrs:{src:p(6877),alt:"1657612814417"}})]),t._v(" "),a("p",[t._v("​\t\t运行流水线：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6878),alt:"1657612848636"}})]),t._v(" "),a("p",[t._v("​\t运行的流水线我们发现失败了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6879),alt:"1657612903998"}})]),t._v(" "),a("p",[t._v("​    原因是这里使用的mail.example.com这个邮箱")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6880),alt:"1657612981643"}})]),t._v(" "),a("p",[t._v("​\t邮件是配好了全局的邮件，但是对于流水线使用的邮件我们还需要单独配置一下，我们到官网上查看一下")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6881),alt:"1657613131524"}})]),t._v(" "),a("p",[t._v("​\t在应用负载--工作负载--kubesphere-devops-system项目中，编辑yaml配置文件")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6882),alt:"1657613309257"}})]),t._v(" "),a("p",[t._v("​\t\t我们看到这些配置是和邮件相关的配置")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6883),alt:"1657613361714"}})]),t._v(" "),a("p",[t._v("​\t\t我们查看一下邮件服务的端口 ssl和非ssl使用的端口是不一样的这个需要注意下")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6884),alt:"1657613643173"}})]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("​\t\t然后我们配置这个jenkins的配置文件，配置好保存更新")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6885),alt:"1657613728909"}})]),t._v(" "),a("p",[t._v("​\t\t我们重新运行一下这个邮件的流水线")]),t._v(" "),a("p",[t._v("​\t\t\t这个流水线的服务运行成功")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6886),alt:"1657613901519"}})]),t._v(" "),a("p",[t._v("​\t我们进入网易邮箱查看一下是否收到了邮件通知")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6887),alt:"1657613944744"}})]),t._v(" "),a("p",[t._v("​\t没有问题--只不过是我们的动态变量的值没有取出来")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6888),alt:"1657613984326"}})]),t._v(" "),a("p",[t._v("​\t\t这个没有取出来的原因是jenkinsfile中内容单引号的问题，改为双引号")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6889),alt:"1657614074875"}})]),t._v(" "),a("p",[t._v("​\t\t重新运行流水线--")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6890),alt:"1657614113318"}})]),t._v(" "),a("p",[t._v("这次我们的变量就拿到了，如果我们需要使用jenkins的变量的话，就使用双引号的方式")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6891),alt:"1657614190632"}})]),t._v(" "),a("p",[t._v("​\t\t其实我们为了这个发送邮件--我们需要配置俩处，一个是全局的，一个是流水线的")]),t._v(" "),a("p",[t._v("​\t\t\t注意使用jenkins的变量的时候使用双引号包内容")]),t._v(" "),a("p",[a("img",{attrs:{src:p(6892),alt:"1657614433605"}})]),t._v(" "),a("p",[t._v("​\t\t到现在我们的后台的微服务项目就都部署成功了，及流水线和邮件服务，接下来我们需要来部署我们的俩个前端的项目")]),t._v(" "),a("p",[t._v("https://www.bilibili.com/video/BV13Q4y1C7hS?p=124&spm_id_from=pageDriver&vd_source=243ad3a9b323313aa1441e5dd414a4ef")])])}),[],!1,null,null,null);s.default=v.exports}}]);