(window.webpackJsonp=window.webpackJsonp||[]).push([[82],{5018:function(t,s,_){t.exports=_.p+"assets/img/1675604036164.32c51914.png"},5019:function(t,s,_){t.exports=_.p+"assets/img/1675604415362.b513c2c4.png"},5020:function(t,s,_){t.exports=_.p+"assets/img/1675604471807.989e2bf3.png"},5021:function(t,s,_){t.exports=_.p+"assets/img/1675604654412.8442e1c8.png"},5022:function(t,s,_){t.exports=_.p+"assets/img/1675604978038.e63b1561.png"},5023:function(t,s,_){t.exports=_.p+"assets/img/1675605369265.d6394bd9.png"},5024:function(t,s,_){t.exports=_.p+"assets/img/1675605385977.3e3982d7.png"},5025:function(t,s,_){t.exports=_.p+"assets/img/1675605661343.1af0a1f1.png"},5026:function(t,s,_){t.exports=_.p+"assets/img/1675605966534.687d9646.png"},5027:function(t,s,_){t.exports=_.p+"assets/img/1675606146068.76f8f497.png"},5028:function(t,s,_){t.exports=_.p+"assets/img/1675606288321.c28b8ff0.png"},5029:function(t,s,_){t.exports=_.p+"assets/img/1675606676299.3744b6ba.png"},5030:function(t,s,_){t.exports=_.p+"assets/img/1675606814003.9c6768ec.png"},5031:function(t,s,_){t.exports=_.p+"assets/img/1675606870306.8603d863.png"},5032:function(t,s,_){t.exports=_.p+"assets/img/1675606923143.90eb32a0.png"},5033:function(t,s,_){t.exports=_.p+"assets/img/1675607066082.e1bae7e8.png"},5034:function(t,s,_){t.exports=_.p+"assets/img/1675607172033.6e494e32.png"},5035:function(t,s,_){t.exports=_.p+"assets/img/1675607288804.5561f9a9.png"},5036:function(t,s,_){t.exports=_.p+"assets/img/1675607360380.4a422ecb.png"},5037:function(t,s,_){t.exports=_.p+"assets/img/1675607483318.91e4d15b.png"},5038:function(t,s,_){t.exports=_.p+"assets/img/1675607689020.ba25b4b2.png"},5039:function(t,s,_){t.exports=_.p+"assets/img/1675607814701.ac80e5ea.png"},5040:function(t,s,_){t.exports=_.p+"assets/img/1675607907781.979c6dd8.png"},5041:function(t,s,_){t.exports=_.p+"assets/img/1675608138292.612f2379.png"},8890:function(t,s,_){"use strict";_.r(s);var a=_(5),v=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_6、流程初体验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、流程初体验"}},[t._v("#")]),t._v(" 6、流程初体验")]),t._v(" "),a("p",[t._v("​\t\t我们需要让activiti认识这个bpmn文件，那么就需要部署流程")]),t._v(" "),a("h4",{attrs:{id:"_1、部署流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、部署流程"}},[t._v("#")]),t._v(" 1、部署流程")]),t._v(" "),a("p",[t._v("​\t\t部署流程其实就是将这个xml解析保存在我们的数据库中")]),t._v(" "),a("p",[t._v("​\t\t表里没有数据它就不知道这个流程")]),t._v(" "),a("p",[t._v("​\t\t部署的时候我们指定bpmn这个文件，也可以保存png图片，然后给他一个名称，最后deploy部署")]),t._v(" "),a("p",[t._v("​\t\t这个部署其实就相当于解析的xml流程 数据插入到数据库表中了")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5018),alt:"1675604036164"}})]),t._v(" "),a("p",[t._v("我们执行一下这个流程")]),t._v(" "),a("p",[t._v("​\t那么它的部署具体操作了数据库的那些表呢？这个其实很复杂，很少有人能够完全的全部都了解")]),t._v(" "),a("p",[t._v("​\t我们可以了解局部的插入内容")]),t._v(" "),a("p",[t._v("​\tdeployment表中会多一条数据")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5019),alt:"1675604415362"}})]),t._v(" "),a("p",[t._v("​\t流程定义表 re_procdef表中会有一条数据")]),t._v(" "),a("p",[t._v("​\t\t通过这次部署我们就定义了一个流程，而且会保存流程图和bpmn文件的名称")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5020),alt:"1675604471807"}})]),t._v(" "),a("p",[t._v("​\t这个文件存放在哪里呢？")]),t._v(" "),a("p",[t._v("​\t在ge_bytearray这个表中")]),t._v(" "),a("p",[t._v("​\t\tname是资源名称，Btyes字段里面就存放的是完整的资源文件了，类型是BLOB类型")]),t._v(" "),a("p",[t._v("​\t\t我们不光是部署的时候需要加文件，中间环节也有文件，所有的文件都会存放在这个表中")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5021),alt:"1675604654412"}})]),t._v(" "),a("p",[t._v("​\t我们现在完成了单个任务的部署，但是我们在实际开发中肯定是会有多个任务的，那么我们也这样一个个的去部署吗？这样太麻烦了")]),t._v(" "),a("p",[t._v("​\t所以activiti提供了通过zip包的方式上传，这样的话一次上传多个文件，定义多个工作流程")]),t._v(" "),a("p",[t._v("​\t\t将bpmn文件和png图片放一个zip中进行统一上传")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5022),alt:"1675604978038"}})]),t._v(" "),a("p",[t._v("这里需要注意一个问题就是文件的命名规范--注意图片的后缀 png jpg...常用图片的类型，如果有其他图片类型可能上传不上去，还有就是我们使用这种zip包的方式它怎么知道 bpmn和png的关系呢，它在解压zip包后根据 流程的id 去找对应的 png图片，图片名称一定要是流程id的名称才可以")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5023),alt:"1675605369265"}})]),t._v(" "),a("p",[a("img",{attrs:{src:_(5024),alt:"1675605385977"}})]),t._v(" "),a("p",[t._v("​\t\t通过流程id这种方式来匹配png图片识别的--这个规则要清楚")]),t._v(" "),a("h4",{attrs:{id:"_2、启动流程实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、启动流程实例"}},[t._v("#")]),t._v(" 2、启动流程实例")]),t._v(" "),a("p",[t._v("​\t\t有一个员工要请假了，那么我们就需要启动一个流程实例了")]),t._v(" "),a("p",[t._v("​\t同样先是拿到流程引擎对象Processengine")]),t._v(" "),a("p",[t._v("​\t\t然后拿到runtimeService 这个服务")]),t._v(" "),a("p",[t._v("​\t\t然后启动一个流程实例通过key，这个key就是流程的id")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5025),alt:"1675605661343"}})]),t._v(" "),a("p",[t._v("​\t有了这个实例后，员工就可以进行一次请假申请了")]),t._v(" "),a("h4",{attrs:{id:"_3、员工提交申请"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、员工提交申请"}},[t._v("#")]),t._v(" 3、员工提交申请")]),t._v(" "),a("p",[t._v("​\t通过流程引擎ProcessEngine对象")]),t._v(" "),a("p",[t._v("​\t\t然后使用任务服务--TaskService")]),t._v(" "),a("p",[t._v("​\t\t\t首先是查询我的任务--通过taskService来查询我的任务")]),t._v(" "),a("p",[t._v("​\t\t\t在查询中设置流程的key--查询的流程")]),t._v(" "),a("p",[t._v("​\t\t\t还需要设置责任人 -- Assignee --这里设置的是worker这个人")]),t._v(" "),a("p",[t._v("​\t比如由worker来进行这个任务")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5026),alt:"1675605966534"}})]),t._v(" "),a("p",[t._v("​\t最后我们输出一下查到的内容：")]),t._v(" "),a("p",[t._v("​\t\t\t流程实例的id，任务的id，负责人，任务名称 都是可以查看到的")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5027),alt:"1675606146068"}})]),t._v(" "),a("h4",{attrs:{id:"_4、完成任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4、完成任务"}},[t._v("#")]),t._v(" 4、完成任务")]),t._v(" "),a("p",[t._v("​\t\t完成任务还是使用taskService")]),t._v(" "),a("p",[t._v("​\t\t还是先查询--设置流程key和责任人")]),t._v(" "),a("p",[t._v("​\t\t获取任务singleResult 会返回一个 task -- singleResult表示只返回一个对象，一个任务")]),t._v(" "),a("p",[t._v("​\t\t通过task拿到 task 的id 然后 使用TaskService的 complete完成任务")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5028),alt:"1675606288321"}})]),t._v(" "),a("p",[t._v("​\t\t我们查询一下任务使用worker用户查询不到任务了，我们使用manager用户查询一下可以查询到，说明流程正常的流转走到manager用户这里了")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5029),alt:"1675606676299"}})]),t._v(" "),a("p",[t._v("​\t接下来就是由manager来完成这个任务---一步步推动这个流程进行")]),t._v(" "),a("h4",{attrs:{id:"_5、查询流程定义"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5、查询流程定义"}},[t._v("#")]),t._v(" 5、查询流程定义")]),t._v(" "),a("p",[t._v("​\t\t我们这个就是查询在这个bpmn文件下有多少个流程定义--也就是部署的流程")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5030),alt:"1675606814003"}})]),t._v(" "),a("p",[t._v("​\t流程重复定义后 --会发生version的变化，不会影响原流程运转")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5031),alt:"1675606870306"}})]),t._v(" "),a("h4",{attrs:{id:"_6、查询当前流程定义下的流程实例"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6、查询当前流程定义下的流程实例"}},[t._v("#")]),t._v(" 6、查询当前流程定义下的流程实例")]),t._v(" "),a("p",[t._v("​\t\t\t也就是某个流程部署下进行中的流程")]),t._v(" "),a("p",[t._v("​\t\t\t传入流程定义key")]),t._v(" "),a("p",[t._v("​\t\t\t就是由那些正在处理中的流程实例")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5032),alt:"1675606923143"}})]),t._v(" "),a("p",[t._v("​\t\t查询到目前这个流程定义下--目前有一个流程在进行")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5033),alt:"1675607066082"}})]),t._v(" "),a("p",[t._v("​\t那么这样我们就可以随时跟踪 这个任务执行的情况")]),t._v(" "),a("h4",{attrs:{id:"_7、删除流程部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7、删除流程部署"}},[t._v("#")]),t._v(" 7、删除流程部署")]),t._v(" "),a("p",[t._v("​\t\t我们一般是不会删除流程部署的，除非是这个流程出现问题了")]),t._v(" "),a("p",[t._v("​\t需要流程部署id")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5034),alt:"1675607172033"}})]),t._v(" "),a("p",[t._v("​\t\t如果这个流程还没有处理完成---无法删除流程部署--会报错的")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5035),alt:"1675607288804"}})]),t._v(" "),a("p",[t._v("​\t也可以强制删除--级联删除 会删除相关的流程数据 参数中添加一个 true就是强制删除")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5036),alt:"1675607360380"}})]),t._v(" "),a("p",[t._v("​\t\t\t\t这个一般只会给管理员使用")]),t._v(" "),a("h4",{attrs:{id:"_8、获取流程定义文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8、获取流程定义文件"}},[t._v("#")]),t._v(" 8、获取流程定义文件")]),t._v(" "),a("p",[t._v("​\t使用RepositoryService")]),t._v(" "),a("p",[t._v("​\t\t\t先是查询某个流程的定义--然后通过流程定义进行查询")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5037),alt:"1675607483318"}})]),t._v(" "),a("p",[t._v("​\t\t这个有什么用呢？如果我们做一个web系统的话，开发人员和业务人员都可以看到这个流程定义了")]),t._v(" "),a("h4",{attrs:{id:"_9、查看历史信息"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_9、查看历史信息"}},[t._v("#")]),t._v(" 9、查看历史信息")]),t._v(" "),a("p",[t._v("​\t\t使用historyService")]),t._v(" "),a("p",[t._v("​\t\t查询流程经过了那些具体的步骤")]),t._v(" "),a("p",[t._v("​\t\t\t\t创建query实例对象--设置query的属性(也就是查询条件) 还可以设置排序")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5038),alt:"1675607689020"}})]),t._v(" "),a("p",[t._v("​\t\t通过list方法就可以查询出来历史结果了")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5039),alt:"1675607814701"}})]),t._v(" "),a("p",[t._v("​\t我们可以看到一些历史步骤")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5040),alt:"1675607907781"}})]),t._v(" "),a("p",[t._v("​\t\t这里就完成了 activiti 的入门了")]),t._v(" "),a("h4",{attrs:{id:"_10、总结"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_10、总结"}},[t._v("#")]),t._v(" 10、总结")]),t._v(" "),a("p",[a("img",{attrs:{src:_(5041),alt:"1675608138292"}})]),t._v(" "),a("p",[t._v("https://www.bilibili.com/video/BV1Ya411z7kW?p=6&spm_id_from=pageDriver&vd_source=243ad3a9b323313aa1441e5dd414a4ef")])])}),[],!1,null,null,null);s.default=v.exports}}]);