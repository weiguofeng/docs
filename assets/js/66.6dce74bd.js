(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{2994:function(t,s,p){t.exports=p.p+"assets/img/1640054274038.5521e61e.png"},2995:function(t,s,p){t.exports=p.p+"assets/img/1640054410516.86b48b22.png"},2996:function(t,s,p){t.exports=p.p+"assets/img/1640054658353.88a73797.png"},2997:function(t,s,p){t.exports=p.p+"assets/img/1640054610810.0a1a0969.png"},2998:function(t,s,p){t.exports=p.p+"assets/img/1640054752872.e86d612f.png"},2999:function(t,s,p){t.exports=p.p+"assets/img/1640055034905.76aa17be.png"},3e3:function(t,s,p){t.exports=p.p+"assets/img/1640055128572.04511736.png"},3001:function(t,s,p){t.exports=p.p+"assets/img/1640056263039.5438b57c.png"},3002:function(t,s,p){t.exports=p.p+"assets/img/1640055541460.0feb5336.png"},3003:function(t,s,p){t.exports=p.p+"assets/img/1640056780323.38859e51.png"},3004:function(t,s,p){t.exports=p.p+"assets/img/1640056670170.706b5905.png"},3005:function(t,s,p){t.exports=p.p+"assets/img/1640056848089.e8f5f917.png"},3006:function(t,s,p){t.exports=p.p+"assets/img/1640056918660.ac6b51e9.png"},3007:function(t,s,p){t.exports=p.p+"assets/img/1640057330178.f79a0240.png"},3008:function(t,s,p){t.exports=p.p+"assets/img/1640058937421.05522e40.png"},3009:function(t,s,p){t.exports=p.p+"assets/img/1640058967574.ec7feed6.png"},3010:function(t,s,p){t.exports=p.p+"assets/img/1640059175284.1ae891ec.png"},3011:function(t,s,p){t.exports=p.p+"assets/img/1640059406376.2eb4f134.png"},3012:function(t,s,p){t.exports=p.p+"assets/img/1640059555240.5536f485.png"},3013:function(t,s,p){t.exports=p.p+"assets/img/1640059599027.1c2e1e79.png"},3014:function(t,s,p){t.exports=p.p+"assets/img/1640071415241.5453949e.png"},3015:function(t,s,p){t.exports=p.p+"assets/img/1640071754613.c135ce56.png"},3016:function(t,s,p){t.exports=p.p+"assets/img/1640072077570.86e9ac34.png"},3017:function(t,s,p){t.exports=p.p+"assets/img/1640672852746.faed492f.png"},3018:function(t,s,p){t.exports=p.p+"assets/img/1640672994290.795b8231.png"},3019:function(t,s,p){t.exports=p.p+"assets/img/1640673046976.8027bd7b.png"},9045:function(t,s,p){"use strict";p.r(s);var a=p(5),e=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_16-草稿箱-更新新闻"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_16-草稿箱-更新新闻"}},[t._v("#")]),t._v(" 16.草稿箱-更新新闻")]),t._v(" "),a("p",[t._v("​\t在草稿箱中我们可以点击更新按钮--然后进行新闻的更新")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2994),alt:"1640054274038"}})]),t._v(" "),a("p",[t._v("点击更新按钮-添加事件--跳转到更新页面")]),t._v(" "),a("p",[t._v("​\t\t跳转到我们这个路由中，但是我们好像没有配置这个路由")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2995),alt:"1640054410516"}})]),t._v(" "),a("p",[t._v("配置一下路由：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2996),alt:"1640054658353"}})]),t._v(" "),a("p",[t._v("创建一个新闻更新的组件newsUpdate.js")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2997),alt:"1640054610810"}})]),t._v(" "),a("p",[t._v("点击编辑查看效果：没有问题可以跳转")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2998),alt:"1640054752872"}})]),t._v(" "),a("p",[t._v("更新和新增其实基本使用的差不多，我们可以copy一下新增的组件，复用一下")]),t._v(" "),a("p",[t._v("更新是支持返回的-我们设置一下返回")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2999),alt:"1640055034905"}})]),t._v(" "),a("p",[t._v("页面查看效果：点击返回也是可以返回到草稿箱的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3e3),alt:"1640055128572"}})]),t._v(" "),a("p",[t._v("我们现在发起请求然后设置一下值----设置值分为俩块 1设置新闻内容，2设置表单内容")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3001),alt:"1640056263039"}})]),t._v(" "),a("p",[t._v("Form表单内容可以回显了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3002),alt:"1640055541460"}})]),t._v(" "),a("p",[t._v("content内容我们也可以直接结构出来")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3003),alt:"1640056780323"}})]),t._v(" "),a("p",[t._v("设置content内容--需要父传子的的方式传给NewsEditor组件")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3004),alt:"1640056670170"}})]),t._v(" "),a("p",[t._v("我们先把content这个值设置一下：然后再进行父子传值")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3005),alt:"1640056848089"}})]),t._v(" "),a("p",[t._v("现在我们给子组件传入过去")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3006),alt:"1640056918660"}})]),t._v(" "),a("p",[t._v("https://www.bilibili.com/video/BV13v411H74b?p=45&spm_id_from=pageDriver")]),t._v(" "),a("h4",{attrs:{id:"_2、设置回显的content值"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、设置回显的content值"}},[t._v("#")]),t._v(" 2、设置回显的Content值")]),t._v(" "),a("p",[t._v("​\tcontent的值已经从父组件传入到子组件中")]),t._v(" "),a("p",[t._v("现在有个问题，就是我们拿到的content是一个html片段，html片段可以直接放入回显吗？肯定是不能的")]),t._v(" "),a("p",[t._v("​\t我们需要将这个html片段再次转换成drift对象然后放入富文本编辑器中才可以")]),t._v(" "),a("p",[t._v("先接收一下这个值--打印一下")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3007),alt:"1640057330178"}})]),t._v(" "),a("p",[t._v("注意：你使用useEffect你用我还得依赖我")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3008),alt:"1640058937421"}})]),t._v(" "),a("p",[t._v("我们拿到这个值了：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3009),alt:"1640058967574"}})]),t._v(" "),a("p",[t._v("我们需要将这个html片段转换为drift然后再转换为我们的setEditorState")]),t._v(" "),a("p",[t._v("​\t\t我们需要看一下这个文档来看一下如何的转化")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3010),alt:"1640059175284"}})]),t._v(" "),a("p",[t._v("还需要下载一个模块 html-to-driftjs")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3011),alt:"1640059406376"}})]),t._v(" "),a("p",[a("img",{attrs:{src:p(3012),alt:"1640059555240"}})]),t._v(" "),a("p",[t._v("运行查看效果：")]),t._v(" "),a("p",[t._v("点击下一步--成功了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3013),alt:"1640059599027"}})]),t._v(" "),a("p",[t._v("我们现在更想是好了--但是在点击撰写新闻的时候--发生报错了")]),t._v(" "),a("p",[t._v("​\t\t这个报错是咱们下载的第三方模块-draft.js报的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3014),alt:"1640071415241"}})]),t._v(" "),a("p",[t._v("原因是： 在添加新闻的时候也会给子组件传入值，但是传入的还是空的，然后htmlToDraft转换了一个空的html导致的错误，我们来给做个数据的校验")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3015),alt:"1640071754613"}})]),t._v(" "),a("p",[t._v("如果html片段是空的就return就ok了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3016),alt:"1640072077570"}})]),t._v(" "),a("p",[t._v("页面测试： 没有问题了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3017),alt:"1640672852746"}})]),t._v(" "),a("p",[t._v("​")]),t._v(" "),a("p",[t._v("我们在点击按钮进行确认的时候：注意更新操作的请求就不是post请求了--应该是补丁更新")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3018),alt:"1640672994290"}})]),t._v(" "),a("p",[t._v("其他不改变的数据可以去掉：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(3019),alt:"1640673046976"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);