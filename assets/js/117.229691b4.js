(window.webpackJsonp=window.webpackJsonp||[]).push([[117],{7536:function(s,t,e){s.exports=e.p+"assets/img/1654940296926.37659636.png"},7537:function(s,t,e){s.exports=e.p+"assets/img/1654940339331.82a0448e.png"},7538:function(s,t,e){s.exports=e.p+"assets/img/1654940412945.6d1c54a1.png"},7539:function(s,t,e){s.exports=e.p+"assets/img/1654940485671.8d374350.png"},7540:function(s,t,e){s.exports=e.p+"assets/img/1654940794187.1f519ec6.png"},7541:function(s,t,e){s.exports=e.p+"assets/img/1654940960849.34f2bc6a.png"},7542:function(s,t,e){s.exports=e.p+"assets/img/1654941596399.f1201595.png"},7543:function(s,t,e){s.exports=e.p+"assets/img/1654941690608.7ee4b7b4.png"},7544:function(s,t,e){s.exports=e.p+"assets/img/1654941801897.9add1193.png"},7545:function(s,t,e){s.exports=e.p+"assets/img/1654941985319.f76c0d08.png"},7546:function(s,t,e){s.exports=e.p+"assets/img/1654942054569.828a6319.png"},7547:function(s,t,e){s.exports=e.p+"assets/img/1654942159705.8b33dcc1.png"},7548:function(s,t,e){s.exports=e.p+"assets/img/1654942431438.9ce4389d.png"},7549:function(s,t,e){s.exports=e.p+"assets/img/1654942543029.5fed8e00.png"},7550:function(s,t,e){s.exports=e.p+"assets/img/1654942611329.3d61bd69.png"},7551:function(s,t,e){s.exports=e.p+"assets/img/1654942692879.88b682e1.png"},7552:function(s,t,e){s.exports=e.p+"assets/img/1654942726077.cd51aa43.png"},7553:function(s,t,e){s.exports=e.p+"assets/img/1654942836038.42c8b657.png"},7554:function(s,t,e){s.exports=e.p+"assets/img/1654942872290.43adcaf4.png"},7555:function(s,t,e){s.exports=e.p+"assets/img/1654942915120.f53b932b.png"},7556:function(s,t,e){s.exports=e.p+"assets/img/1654942972941.27975574.png"},9175:function(s,t,e){"use strict";e.r(t);var a=e(5),n=Object(a.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_7-kubesphere-平台安装-单节点上kubekey一键安装完整平台"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-kubesphere-平台安装-单节点上kubekey一键安装完整平台"}},[s._v("#")]),s._v(" 7.kubesphere-平台安装-单节点上kubeKey一键安装完整平台")]),s._v(" "),a("p",[s._v("​\t下面我们了解kubesphere的第二种安装方式")]),s._v(" "),a("h2",{attrs:{id:"在linux单节点部署kubesphere"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在linux单节点部署kubesphere"}},[s._v("#")]),s._v(" 在Linux单节点部署Kubesphere")]),s._v(" "),a("h4",{attrs:{id:"_1、开通服务器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、开通服务器"}},[s._v("#")]),s._v(" 1、开通服务器")]),s._v(" "),a("p",[s._v("​\t\t\t比如我们现在有一个4core 8g的服务器，CentOS7.9，防火墙开启30000-32767端口")]),s._v(" "),a("p",[s._v("​\t\t\t指定个hostname--一般我们都要指定一下方便我们理解这个是哪个服务器")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 指定hostname\nhostnamectl set-hostname node1\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"_2、安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、安装"}},[s._v("#")]),s._v(" 2、安装")]),s._v(" "),a("p",[s._v("​\t我们想一键的把kubesphere及k8s整个一键安装上来")]),s._v(" "),a("p",[s._v("​\t我们参照kubesphere的官方文档")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7536),alt:"1654940296926"}})]),s._v(" "),a("p",[s._v("​\t然后我们查看硬件的配置：")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7537),alt:"1654940339331"}})]),s._v(" "),a("h5",{attrs:{id:"_2-1下载kubekey"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1下载kubekey"}},[s._v("#")]),s._v(" 2.1下载kubekey")]),s._v(" "),a("p",[s._v("​\t然后我们需要下载kubesphere官方为我们提供的一个KubeKey")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7538),alt:"1654940412945"}})]),s._v(" "),a("p",[s._v("​\t\t如果访问google受限，我们使用另外一种下载方式")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7539),alt:"1654940485671"}})]),s._v(" "),a("p",[s._v("​\t准备kubekey---我们使用这个新的服务器为例")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 首先运行以下命令，以确保您从正确的区域下载 KubeKey。\nexport KKZONE=cn\n\n# 运行以下命令来下载 KubeKey：\ncurl -sfL https://get-kk.kubesphere.io | VERSION=v1.0.1 sh -\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("​\t官方提供的命令先设置导出一下地区export KKZONE = CN，然后执行下载命令")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7540),alt:"1654940794187"}})]),s._v(" "),a("p",[s._v("​\t\t显示kubekey DownLoad Complete就下载完成了")]),s._v(" "),a("p",[s._v("下载完成后会有 kk的可执行文件，还有kubekey的压缩文件")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7541),alt:"1654940960849"}})]),s._v(" "),a("p",[s._v("然后是给kk添加可执行权限--只要是绿色就有权限，chmod +x是最高权限")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("chmod +x kk\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h5",{attrs:{id:"_2-2-使用kubekey引导安装集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-使用kubekey引导安装集群"}},[s._v("#")]),s._v(" 2.2 使用kubekey引导安装集群")]),s._v(" "),a("p",[s._v("​\t我们现在开的是新的机器，是非常纯净的Linux系统，我们现在希望把kubesphere及k8s一整套全部的安装好。")]),s._v(" "),a("p",[s._v("​")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#可能需要下面命令")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y conntrack\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 这个命令是使用kubekey创建一个集群，k8s的版本使用的是1.20.4，kubesphere版本是3.1.1")]),s._v("\n./kk create cluster --with-kubernetes v1.20.4 --with-kubesphere v3.1.1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("创建的时候可能会提示这个，就是我们的环境可能没有准备就绪，比如这个conntrack和网络有关的")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7542),alt:"1654941596399"}})]),s._v(" "),a("p",[s._v("然后就是安装一下conntrack")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7543),alt:"1654941690608"}})]),s._v(" "),a("p",[s._v("然后在执行kubekey的命令，会提示是否安装输入yes，然后我们就什么都不用管了等待安装完成")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7544),alt:"1654941801897"}})]),s._v(" "),a("p",[s._v("等到显示这个 Please wait 就安装的差不多了")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7545),alt:"1654941985319"}})]),s._v(" "),a("p",[s._v("我们也可以使用命令kubectl get pod来查看安装的进度")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7546),alt:"1654942054569"}})]),s._v(" "),a("p",[s._v("安装完成后会有提示")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7547),alt:"1654942159705"}})]),s._v(" "),a("p",[s._v("​\t\t这种方式安装很方便，就是无人值守，一键安装，我们在开发期间如果想测试这个平台就可以这么来用。")]),s._v(" "),a("p",[s._v("但这块的安装大家会发现会少很多东西，因为他安装的不是全功能平台，这个"),a("strong",[s._v("默认安装的是最小化安装。")])]),s._v(" "),a("p",[s._v("​\t如果我们想要启动一些功能，那么就查看官方文档--进入启用可插拔组件")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7548),alt:"1654942431438"}})]),s._v(" "),a("h4",{attrs:{id:"_3、安装后启用功能"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、安装后启用功能"}},[s._v("#")]),s._v(" 3、安装后启用功能")]),s._v(" "),a("p",[s._v("比如开启devops")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7549),alt:"1654942543029"}})]),s._v(" "),a("p",[s._v("​\t然后就是自定义资源CRD输入 clusterconfiguration")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7550),alt:"1654942611329"}})]),s._v(" "),a("p",[s._v("然后点击这个集群的配置")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7551),alt:"1654942692879"}})]),s._v(" "),a("p",[s._v("可以看到kubesphere的安装器，点击编辑配置文件")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7552),alt:"1654942726077"}})]),s._v(" "),a("p",[s._v("​\t然后就看到我们以前配置过的yaml配置，我们在spec下想开启什么功能就把false改为true就可以了")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7553),alt:"1654942836038"}})]),s._v(" "),a("p",[s._v("比如我们开启devops---设置为true，然后点击更新")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7554),alt:"1654942872290"}})]),s._v(" "),a("p",[s._v("如果后期我们想关闭一些功能也是这样，关闭改为false就可以了")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7555),alt:"1654942915120"}})]),s._v(" "),a("p",[s._v("原来是没有devops的--我们应用后一会在组件状态中就会显示devops")]),s._v(" "),a("p",[a("img",{attrs:{src:e(7556),alt:"1654942972941"}})]),s._v(" "),a("p",[s._v("​\t注意："),a("strong",[s._v("因为这个是单节点，目前适用于只有一个节点的Linux系统，适用于我们开发用来测试")])])])}),[],!1,null,null,null);t.default=n.exports}}]);