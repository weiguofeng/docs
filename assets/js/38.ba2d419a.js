(window.webpackJsonp=window.webpackJsonp||[]).push([[38],{4479:function(t,s,a){t.exports=a.p+"assets/img/1683532052676.3f57f369.png"},4480:function(t,s,a){t.exports=a.p+"assets/img/1683532183012.cc2634eb.png"},4481:function(t,s,a){t.exports=a.p+"assets/img/1683532233453.2e1a3e89.png"},4482:function(t,s,a){t.exports=a.p+"assets/img/1683532327246.2abc3e2d.png"},4483:function(t,s,a){t.exports=a.p+"assets/img/1683532552188.ec715623.png"},4484:function(t,s,a){t.exports=a.p+"assets/img/1683532609315.69a7c553.png"},4485:function(t,s,a){t.exports=a.p+"assets/img/1683532723142.61a53411.png"},4486:function(t,s,a){t.exports=a.p+"assets/img/1683532892507.b9ecc3f5.png"},4487:function(t,s,a){t.exports=a.p+"assets/img/1683533769143.d5d1f208.png"},4488:function(t,s,a){t.exports=a.p+"assets/img/1683533928429.a8babd61.png"},4489:function(t,s,a){t.exports=a.p+"assets/img/1683534150672.da8a1830.png"},4490:function(t,s,a){t.exports=a.p+"assets/img/1683534261797.b2572e5c.png"},4491:function(t,s,a){t.exports=a.p+"assets/img/1683536172821.58333f37.png"},4492:function(t,s,a){t.exports=a.p+"assets/img/1683536244369.027694d1.png"},4493:function(t,s,a){t.exports=a.p+"assets/img/1683536349277.69b3ff93.png"},4494:function(t,s,a){t.exports=a.p+"assets/img/1683536419858.8b3e46d9.png"},4495:function(t,s,a){t.exports=a.p+"assets/img/1683536596481.98b0063b.png"},4496:function(t,s,a){t.exports=a.p+"assets/img/1683536668175.69e265b2.png"},4497:function(t,s,a){t.exports=a.p+"assets/img/1683536710288.f199d2a5.png"},4498:function(t,s,a){t.exports=a.p+"assets/img/1683536840679.8fb57369.png"},4499:function(t,s,a){t.exports=a.p+"assets/img/1683536884230.89c58de3.png"},4500:function(t,s,a){t.exports=a.p+"assets/img/1683537034167.10b7f7d1.png"},4501:function(t,s,a){t.exports=a.p+"assets/img/1683537135475.efa27b1a.png"},4502:function(t,s,a){t.exports=a.p+"assets/img/1683537168844.4ba42c1f.png"},4503:function(t,s,a){t.exports=a.p+"assets/img/1683537205472.acf16237.png"},4504:function(t,s,a){t.exports=a.p+"assets/img/1683537240965.ec3bcf82.png"},4505:function(t,s,a){t.exports=a.p+"assets/img/1683542867386.8f9e669c.png"},4506:function(t,s,a){t.exports=a.p+"assets/img/1683543096416.1298013e.png"},4507:function(t,s,a){t.exports=a.p+"assets/img/1683543161799.ded75ac9.png"},4508:function(t,s,a){t.exports=a.p+"assets/img/1683543264055.e3b9b759.png"},4509:function(t,s,a){t.exports=a.p+"assets/img/1683543542273.8171185d.png"},9162:function(t,s,a){"use strict";a.r(s);var r=a(5),p=Object(r.a)({},(function(){var t=this,s=t.$createElement,r=t._self._c||s;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"_28、dockerfile构建应用2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_28、dockerfile构建应用2"}},[t._v("#")]),t._v(" 28、dockerfile构建应用2")]),t._v(" "),r("p",[t._v("​\t\t"),r("img",{attrs:{src:a(4479),alt:"1683532052676"}})]),t._v(" "),r("p",[t._v("​\t\t前面我们已经完成了前三步，接下来就是项目打包")]),t._v(" "),r("h2",{attrs:{id:"_1、打包"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1、打包"}},[t._v("#")]),t._v(" 1、打包")]),t._v(" "),r("p",[t._v("​\t\t打包前我们先跳过测试")]),t._v(" "),r("p",[t._v("​\t\t点击一下maven中的test，然后点击idea的闪电标识，代表跳过测试")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4480),alt:"1683532183012"}})]),t._v(" "),r("p",[t._v("​\t然后test就变成灰色的了--然后点击package")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4481),alt:"1683532233453"}})]),t._v(" "),r("p",[t._v("​\tjar包已生成")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4482),alt:"1683532327246"}})]),t._v(" "),r("h2",{attrs:{id:"_2、根据jar包生成镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2、根据jar包生成镜像"}},[t._v("#")]),t._v(" 2、根据jar包生成镜像")]),t._v(" "),r("h4",{attrs:{id:"_1、创建dockerfile"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1、创建dockerfile"}},[t._v("#")]),t._v(" 1、创建dockerfile")]),t._v(" "),r("p",[t._v("​\tSFTP连接一下远程主机---因为我们的docker引擎是在远程主机上的")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4483),alt:"1683532552188"}})]),t._v(" "),r("p",[t._v("​\t创建一个apps目录---用来运行我们自己的项目")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4484),alt:"1683532609315"}})]),t._v(" "),r("p",[t._v("​\t这个apps作为dockerfile的上下文，将jar包传上来，然后再创建一个dockerfile文件")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4485),alt:"1683532723142"}})]),t._v(" "),r("p",[t._v("idea的终端工具是在Tools下--这样可以使用sftp进行连接")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4486),alt:"1683532892507"}})]),t._v(" "),r("h4",{attrs:{id:"_2、我们需要基于jdk的镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2、我们需要基于jdk的镜像"}},[t._v("#")]),t._v(" 2、我们需要基于jdk的镜像")]),t._v(" "),r("p",[t._v("​\t\t\t在docker hub 中寻找jdk8的版本")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4487),alt:"1683533769143"}})]),t._v(" "),r("p",[t._v("​\t基础镜像是java8的jre")]),t._v(" "),r("h4",{attrs:{id:"_3、编写dockerfile文件"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_3、编写dockerfile文件"}},[t._v("#")]),t._v(" 3、编写dockerfile文件")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4488),alt:"1683533928429"}})]),t._v(" "),r("p",[t._v("​\t\t基础镜像 --》环境变量设置了个路径 --》工作路径 workdir --》添加jar包，且修改名字为apps.jar")]),t._v(" "),r("p",[t._v("​\t\t\t描述端口 Expose 8989")]),t._v(" "),r("p",[t._v("​\t\t存储卷 不需要")]),t._v(" "),r("p",[t._v("​\t\t\t运行是-- ENTRYPOINT ，然后CMD 我们需要运行参数可变的是 apps.jar")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4489),alt:"1683534150672"}})]),t._v(" "),r("p",[t._v("​")]),t._v(" "),r("p",[t._v("​\t\t修改完成--点击上传按钮 ，上传到SFTP服务器")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4490),alt:"1683534261797"}})]),t._v(" "),r("h4",{attrs:{id:"_4、开始构建"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_4、开始构建"}},[t._v("#")]),t._v(" 4、开始构建")]),t._v(" "),r("p",[t._v("​\t\t我们构建一个apps 1.0的版本")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4491),alt:"1683536172821"}})]),t._v(" "),r("p",[t._v("构建完成后我们查看一下")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4492),alt:"1683536244369"}})]),t._v(" "),r("h4",{attrs:{id:"_5、运行镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_5、运行镜像"}},[t._v("#")]),t._v(" 5、运行镜像")]),t._v(" "),r("p",[t._v("​\t加个  -p  将端口映射出来")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4493),alt:"1683536349277"}})]),t._v(" "),r("p",[t._v("我们在访问的时候发现报错了")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4494),alt:"1683536419858"}})]),t._v(" "),r("p",[t._v("​\t原因是他没有数据库")]),t._v(" "),r("p",[t._v("​\t所以所我们需要把应用所依赖的这些数据库 和中间件先运行起来")]),t._v(" "),r("h4",{attrs:{id:"_6、运行一下mysql"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_6、运行一下mysql"}},[t._v("#")]),t._v(" 6、运行一下mysql")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4495),alt:"1683536596481"}})]),t._v(" "),r("p",[t._v("​\t还需要加个-v数据持久化")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4496),alt:"1683536668175"}})]),t._v(" "),r("p",[t._v("​\t检查mysql运行没有问题")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4497),alt:"1683536710288"}})]),t._v(" "),r("h4",{attrs:{id:"_7、数据库初始化"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_7、数据库初始化"}},[t._v("#")]),t._v(" 7、数据库初始化")]),t._v(" "),r("p",[t._v("​\t\t连接创建数据库")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4498),alt:"1683536840679"}})]),t._v(" "),r("p",[t._v("​\t将表数据同步上来")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4499),alt:"1683536884230"}})]),t._v(" "),r("p",[t._v("​\t那么我们现在已经有mysql了，如果运行apps 1.0 的话需要他们在同一个网络中才可以进行连接")]),t._v(" "),r("h4",{attrs:{id:"_8、构建一个网络"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_8、构建一个网络"}},[t._v("#")]),t._v(" 8、构建一个网络")]),t._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("\tdocker network create app\n")])]),t._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[t._v("1")]),r("br")])]),r("p",[r("img",{attrs:{src:a(4500),alt:"1683537034167"}})]),t._v(" "),r("p",[t._v("​\t然后网络连接mysql")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4501),alt:"1683537135475"}})]),t._v(" "),r("p",[r("img",{attrs:{src:a(4502),alt:"1683537168844"}})]),t._v(" "),r("p",[t._v("​\t我们看一下这个网络---mysql已加入")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4503),alt:"1683537205472"}})]),t._v(" "),r("p",[r("img",{attrs:{src:a(4504),alt:"1683537240965"}})]),t._v(" "),r("p",[t._v("既然这个app网络里面有mysql了")]),t._v(" "),r("p",[t._v("​")]),t._v(" "),r("p",[t._v("我们的应用只需要和mysql在同一个网络里就可以通信了")]),t._v(" "),r("p",[t._v("​\t这样的话我们的项目的数据库地址就可以写成 mysql了--这个mysql是容器的名称")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4505),alt:"1683542867386"}})]),t._v(" "),r("p",[t._v("​\t然后重新打包，重新构建")]),t._v(" "),r("p",[t._v("​")]),t._v(" "),r("h4",{attrs:{id:"_9、重新构建运行镜像"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_9、重新构建运行镜像"}},[t._v("#")]),t._v(" 9、重新构建运行镜像")]),t._v(" "),r("h4",{attrs:{id:""}},[r("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")]),t._v(" "),r("img",{attrs:{src:a(4506),alt:"1683543096416"}})]),t._v(" "),r("p",[t._v("​\t\t查看日志")]),t._v(" "),r("p",[t._v("​\t\tdocker logs")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4507),alt:"1683543161799"}})]),t._v(" "),r("p",[t._v("把apps也加入到网络中")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4508),alt:"1683543264055"}})]),t._v(" "),r("p",[t._v("现在访问就可以了")]),t._v(" "),r("p",[r("img",{attrs:{src:a(4509),alt:"1683543542273"}})]),t._v(" "),r("p",[t._v("https://www.bilibili.com/video/BV1wQ4y1Y7SE?p=29&spm_id_from=pageDriver&vd_source=243ad3a9b323313aa1441e5dd414a4ef")])])}),[],!1,null,null,null);s.default=p.exports}}]);