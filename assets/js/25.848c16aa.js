(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{2150:function(t,s,p){t.exports=p.p+"assets/img/1639554539532.82ef214f.png"},2151:function(t,s,p){t.exports=p.p+"assets/img/1639554808733.940dee3c.png"},2152:function(t,s,p){t.exports=p.p+"assets/img/1639555130106.2ec848e7.png"},2153:function(t,s,p){t.exports=p.p+"assets/img/1639555185681.43618bbf.png"},2154:function(t,s,p){t.exports=p.p+"assets/img/1639555232735.023a34a9.png"},2155:function(t,s,p){t.exports=p.p+"assets/img/1639555342039.eeeeb19e.png"},2156:function(t,s,p){t.exports=p.p+"assets/img/1639555517637.bcfc3def.png"},2157:function(t,s,p){t.exports=p.p+"assets/img/1639557015440.db48aae9.png"},2158:function(t,s,p){t.exports=p.p+"assets/img/1639557097421.1848ac78.png"},2159:function(t,s,p){t.exports=p.p+"assets/img/1639557732687.6d900cac.png"},2160:function(t,s,p){t.exports=p.p+"assets/img/1639557877992.ea03259c.png"},2161:function(t,s,p){t.exports=p.p+"assets/img/1639557979123.501e09cd.png"},2162:function(t,s,p){t.exports=p.p+"assets/img/1639558088627.a9008fd2.png"},2163:function(t,s,p){t.exports=p.p+"assets/img/1639558134596.6d9dc14c.png"},2164:function(t,s,p){t.exports=p.p+"assets/img/1639558298677.74d12c01.png"},2165:function(t,s,p){t.exports=p.p+"assets/img/1639558371125.3f73887f.png"},2166:function(t,s,p){t.exports=p.p+"assets/img/1639560293989.7da93280.png"},2167:function(t,s,p){t.exports=p.p+"assets/img/1639560343443.bc4d90b4.png"},2168:function(t,s,p){t.exports=p.p+"assets/img/1639560750789.986c6228.png"},2169:function(t,s,p){t.exports=p.p+"assets/img/1639566458738.70f4b05b.png"},2170:function(t,s,p){t.exports=p.p+"assets/img/1639560886690.15b28ab8.png"},2171:function(t,s,p){t.exports=p.p+"assets/img/1639566594197.d90785bb.png"},2172:function(t,s,p){t.exports=p.p+"assets/img/1639566864564.acb297d5.png"},2173:function(t,s,p){t.exports=p.p+"assets/img/1639567031297.d7ff3c49.png"},2174:function(t,s,p){t.exports=p.p+"assets/img/1639567164406.3455091d.png"},2175:function(t,s,p){t.exports=p.p+"assets/img/1639567491604.8a6be7d4.png"},2176:function(t,s,p){t.exports=p.p+"assets/img/1639567559065.0842632a.png"},2177:function(t,s,p){t.exports=p.p+"assets/img/1639567791638.8d559f60.png"},2178:function(t,s,p){t.exports=p.p+"assets/img/1639568094234.e9ba2748.png"},2179:function(t,s,p){t.exports=p.p+"assets/img/1639568263210.ffeea6ad.png"},2180:function(t,s,p){t.exports=p.p+"assets/img/1639568557001.d3ff2726.png"},2181:function(t,s,p){t.exports=p.p+"assets/img/1639568799488.d13cec9c.png"},2182:function(t,s,p){t.exports=p.p+"assets/img/1639568860775.8592f415.png"},8301:function(t,s,p){"use strict";p.r(s);var a=p(5),r=Object(a.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"_26-用户列表-编辑用户"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_26-用户列表-编辑用户"}},[t._v("#")]),t._v(" 26.用户列表-编辑用户")]),t._v(" "),a("p",[t._v("​\t\t接下来我们需要做的是：")]),t._v(" "),a("p",[t._v("​\t\t\t\t编辑用户，用户的开关--如果用户开关关闭后，用户再想登陆就登陆不了了，需要和登录关联")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2150),alt:"1639554539532"}})]),t._v(" "),a("p",[t._v("现在首先要处理的就是 因为开关是受控组件，目前是关闭不掉的")]),t._v(" "),a("h4",{attrs:{id:"_1、处理受控开关switch"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1、处理受控开关switch"}},[t._v("#")]),t._v(" 1、处理受控开关Switch")]),t._v(" "),a("p",[t._v("​\t\t我们给switch添加一个事件---将item传入进去")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2151),alt:"1639554808733"}})]),t._v(" "),a("p",[t._v("这样传入过来item我们就知道那一项是需要改为关的状态，然后我们再同步我们的后端，再修改当前的页面")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2152),alt:"1639555130106"}})]),t._v(" "),a("p",[t._v("查看一下item--可以获取到整个对象")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2153),alt:"1639555185681"}})]),t._v(" "),a("p",[t._v("我们只需要将roleState改为false然后去同步后端")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2154),alt:"1639555232735"}})]),t._v(" "),a("p",[t._v("比较简单的做法就是 我们将这个值取反就可以了")]),t._v(" "),a("p",[t._v("​\t\t\t然后我们重新设置值 展开数据")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2155),alt:"1639555342039"}})]),t._v(" "),a("p",[t._v("这回页面就可以关闭了---但是刷新页面显回原型 因为没有同步后端")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2156),alt:"1639555517637"}})]),t._v(" "),a("p",[t._v("使用补丁请求--patch 进行更新--更新roleState")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2157),alt:"1639557015440"}})]),t._v(" "),a("p",[t._v("我们重新刷新页面后，关闭或者开启的按钮是不变的，因为已经和后台数据同步了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2158),alt:"1639557097421"}})]),t._v(" "),a("h4",{attrs:{id:"_2、然后点击编辑按钮进行更新"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2、然后点击编辑按钮进行更新"}},[t._v("#")]),t._v(" 2、然后点击编辑按钮进行更新")]),t._v(" "),a("p",[t._v("​\t\t\t点击编辑按钮--需要把内容回显--和新增一样，整一个模态框出来")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2159),alt:"1639557732687"}})]),t._v(" "),a("p",[t._v("设置模态框")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2160),alt:"1639557877992"}})]),t._v(" "),a("p",[t._v("将定义的数据开始创建")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2161),alt:"1639557979123"}})]),t._v(" "),a("p",[t._v("点击编辑按钮--将模态框的显示设置为true 然后打开模态框")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2162),alt:"1639558088627"}})]),t._v(" "),a("p",[t._v("页面查看效果：")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2163),alt:"1639558134596"}})]),t._v(" "),a("p",[t._v("然后我们给Form表单内容回显设置值 -- 使用 setFieldsValue这个方法设置，需要传入对象")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2164),alt:"1639558298677"}})]),t._v(" "),a("p",[t._v("然后点击编辑按钮--查看效果---显示正确---结果一刷新就有问题了，因为是热更新的--我们在弹出模态框的时候")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2165),alt:"1639558371125"}})]),t._v(" "),a("p",[t._v("我们现在处理异步--改为同步处理 --模态框及表单创建完成后 表单进行内容的填充")]),t._v(" "),a("p",[t._v("​\t\t我们房子异步中设置延迟settime 只要在异步中patchUpdate批量的标志位就会自动为false，就不会进行批量合并，这个时候就变成了同步处理方案了")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2166),alt:"1639560293989"}})]),t._v(" "),a("p",[t._v("测试查看效果： 没有问题--点击刷新也没有问题")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2167),alt:"1639560343443"}})]),t._v(" "),a("p",[t._v("注意：React中您别以为你刚更新完State 你的dom呢就好了，你的状态组件都完事了，这怎么可能呢，所以说这种方案来说setTime 是经常用的到的，让他变为同步触发。")]),t._v(" "),a("p",[t._v("设置isUpdateDisable 初始值为false--用于 传给子组件--然后用于设置子组件中是否禁用地域标志")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2168),alt:"1639560750789"}})]),t._v(" "),a("p",[t._v("判断一下角色--然后将是否禁用设置值")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2169),alt:"1639566458738"}})]),t._v(" "),a("p",[t._v("然后在更新的时候给Form组件传入这个值---用于区别是新增还是更新")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2170),alt:"1639560886690"}})]),t._v(" "),a("p",[t._v("传入这个值后--重新设置一下这个值，如果是禁用就改为禁用")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2171),alt:"1639566594197"}})]),t._v(" "),a("p",[t._v("页面测试一下：点击编辑超级管理员--然后区域是禁用好使的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2172),alt:"1639566864564"}})]),t._v(" "),a("p",[t._v("如果点击完超级管理员--我们关闭模态框--再次打开其他的编辑后--发现区域被禁止了")]),t._v(" "),a("p",[t._v("​\t\t原因就是我们没有重新设置值，这个就是因为我们共用一个组件导致的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2173),alt:"1639567031297"}})]),t._v(" "),a("p",[t._v("我们在点击取消的时候--还是需要设置一下值--取反")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2174),alt:"1639567164406"}})]),t._v(" "),a("h4",{attrs:{id:"_3、提交form表单进行修改及校验"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3、提交form表单进行修改及校验"}},[t._v("#")]),t._v(" 3、提交Form表单进行修改及校验")]),t._v(" "),a("p",[t._v("我们先打印一下收集到修改的form表单内容")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2175),alt:"1639567491604"}})]),t._v(" "),a("p",[t._v("可以获取到最新的表单数据")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2176),alt:"1639567559065"}})]),t._v(" "),a("p",[t._v("设置变量current -- 用于编辑时候-我们把这个点击的对象值先保存下来")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2177),alt:"1639567791638"}})]),t._v(" "),a("p",[t._v("存一下这个编辑的对象到setcurrent中---在将来点击ok更新的时候使用")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2178),alt:"1639568094234"}})]),t._v(" "),a("p",[t._v("然后我们点击ok的时候--重新设置值的时候")]),t._v(" "),a("p",[t._v("​\t\t判断item的id和current旧值的id是否一致，一致就代表改的就是这项")]),t._v(" "),a("p",[t._v("​\t\t然后将item展开，value值展开设置值，注意还有设置角色的值")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2179),alt:"1639568263210"}})]),t._v(" "),a("p",[t._v("如果id不相等就返回item ，最后还需要设置一下禁用的值取反--否则会导致地域禁用不好使的问题")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2180),alt:"1639568557001"}})]),t._v(" "),a("p",[t._v("同步到后端---发一个patch请求 增量更新")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2181),alt:"1639568799488"}})]),t._v(" "),a("p",[t._v("然后页面查看效果：然后更新效果好使的")]),t._v(" "),a("p",[a("img",{attrs:{src:p(2182),alt:"1639568860775"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);