(window.webpackJsonp=window.webpackJsonp||[]).push([[207],{7211:function(t,s,a){t.exports=a.p+"assets/img/1655396478859.920c39b9.png"},7212:function(t,s,a){t.exports=a.p+"assets/img/1655396656352.6b6f2f8b.png"},7213:function(t,s,a){t.exports=a.p+"assets/img/1655396911854.e7b47012.png"},7214:function(t,s,a){t.exports=a.p+"assets/img/1655397188681.eb956bf6.png"},7215:function(t,s,a){t.exports=a.p+"assets/img/1655397305610.456ad4d8.png"},7216:function(t,s,a){t.exports=a.p+"assets/img/1655397412077.6aeeeb56.png"},7217:function(t,s,a){t.exports=a.p+"assets/img/1655397586680.f3f6a3ee.png"},7218:function(t,s,a){t.exports=a.p+"assets/img/1655397658312.69488259.png"},7219:function(t,s,a){t.exports=a.p+"assets/img/1655398137130.1c426a9c.png"},7220:function(t,s,a){t.exports=a.p+"assets/img/1655398238779.df6c0523.png"},7221:function(t,s,a){t.exports=a.p+"assets/img/1655398322925.64165dac.png"},7222:function(t,s,a){t.exports=a.p+"assets/img/1655398545612.b49ee9c1.png"},7223:function(t,s,a){t.exports=a.p+"assets/img/1655398629680.902d05f8.png"},7224:function(t,s,a){t.exports=a.p+"assets/img/1655398857095.26173540.png"},8914:function(t,s,a){"use strict";a.r(s);var n=a(5),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"_28-kubernetes应用部署实战-java微服务上云-镜像推送"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_28-kubernetes应用部署实战-java微服务上云-镜像推送"}},[t._v("#")]),t._v(" 28.kubernetes应用部署实战-Java微服务上云-镜像推送")]),t._v(" "),n("p",[t._v("​\t\t我们之前是把本地打好的jar包已经通过ftp上传到了服务器")]),t._v(" "),n("p",[t._v("​\t\t接下来就是进入到每个项目里面制作镜像")]),t._v(" "),n("p",[t._v("​")]),t._v(" "),n("p",[t._v("​\t\tdocker build -t 镜像名称:版本 -f 指定dockerfile .")]),t._v(" "),n("p",[t._v("​\t\t\t最后的这个点. 指在当前目录工作--因为dockerfile里面有行代码是要拷贝当前路径下的target文件内容的")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7211),alt:"1655396478859"}})]),t._v(" "),n("p",[t._v("一共是7步，因为我们dockerfile中有7行代码，代表7个步骤，最重要的是第五个步骤")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7212),alt:"1655396656352"}})]),t._v(" "),n("p",[t._v("​\t之后所有的ruoyi其他的微服务jar包都是这么制作镜像的")]),t._v(" "),n("p",[t._v("​\t现在我们检查一下和ruoyi有关的镜像")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7213),alt:"1655396911854"}})]),t._v(" "),n("p",[t._v("​\t现在我们的镜像只是在master节点--但是它不能只在master节点，因为我们集群可能有几十台机器，其他机器同样需要部署，那么就"),n("strong",[t._v("需要从master节点把镜像推送到镜像仓库")]),t._v("了--我们使用阿里云的镜像仓库")]),t._v(" "),n("p",[t._v("​\t\t阿里云菜单下--容器与镜像服务")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7214),alt:"1655397188681"}})]),t._v(" "),n("p",[t._v("​\t我们使用个人版实例是免费的--但是有限额，这个命名空间相当于这个仓库要给哪里传，")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7215),alt:"1655397305610"}})]),t._v(" "),n("p",[t._v("​\t我们可以将命名空间设置为公开的，公开就是大家都可以来这个仓库进行下载镜像，所以我们现在就把这些镜像往这个空间里面上传")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7216),alt:"1655397412077"}})]),t._v(" "),n("p",[t._v("​\t上传镜像到这里需要遵循一个什么样的标准呢？我們看一下这个访问凭证，如果想要上传镜像就需要先登录，按这个指令进行登录")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7217),alt:"1655397586680"}})]),t._v(" "),n("p",[t._v("​\t改为自己的用户名--然后输入密码，登录成功")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7218),alt:"1655397658312"}})]),t._v(" "),n("p",[t._v("​\t镜像的推送--阿里云的镜像地址+名称空间+镜像名称：镜像版本号")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" login --username"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("forsum**** registry.cn-hangzhou.aliyuncs.com\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#把本地镜像，改名，成符合阿里云名字规范的镜像。")]),t._v("\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" tag "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("ImageId"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" registry.cn-hangzhou.aliyuncs.com/lfy_ruoyi/镜像名:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("镜像版本号"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## docker tag 461955fe1e57 registry.cn-hangzhou.aliyuncs.com/lfy_ruoyi/ruoyi-visual-monitor:v1")]),t._v("\n\n$ "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("docker")]),t._v(" push registry.cn-hangzhou.aliyuncs.com/lfy_ruoyi/镜像名:"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("镜像版本号"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("## docker push registry.cn-hangzhou.aliyuncs.com/lfy_ruoyi/ruoyi-visual-monitor:v1")]),t._v("\n\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br")])]),n("p",[t._v("​")]),t._v(" "),n("p",[t._v("​\tdocker tag 相当于给镜像改了个名字，tag后是可以是镜像的名称/id")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7219),alt:"1655398137130"}})]),t._v(" "),n("p",[t._v("然后推送，此时推送必须是镜像名称，不可以使用镜像id进行推送")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7220),alt:"1655398238779"}})]),t._v(" "),n("p",[t._v("​")]),t._v(" "),n("p",[t._v("​\t推送成功后，我们在这个容器镜像里面看一下--已经推送上来了")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7221),alt:"1655398322925"}})]),t._v(" "),n("p",[t._v("我们把其他的镜像也先改为符合阿里云的规则名字，然后进行推送")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7222),alt:"1655398545612"}})]),t._v(" "),n("p",[t._v("​\t这些微服务都推送完毕")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7223),alt:"1655398629680"}})]),t._v(" "),n("p",[t._v("​\t我们发现这些都是一些手动体力活，这些微服务还比较少，那么如果这些微服务很多呢比如几百个服务呢，我们需要考虑一下有没有一个自动化的流程")]),t._v(" "),n("p",[t._v("​\t还有就是如果是在公司我们可以使用自建镜像仓库比如 habor--由于是内网，推送和下载也会比较快")]),t._v(" "),n("p",[n("img",{attrs:{src:a(7224),alt:"1655398857095"}})]),t._v(" "),n("p",[t._v("https://www.bilibili.com/video/BV13Q4y1C7hS?p=96&spm_id_from=pageDriver&vd_source=243ad3a9b323313aa1441e5dd414a4ef")])])}),[],!1,null,null,null);s.default=r.exports}}]);